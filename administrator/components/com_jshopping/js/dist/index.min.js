(function(e){var t={};function __webpack_require__(r){if(t[r]){return t[r].exports}var n=t[r]={i:r,l:false,exports:{}};e[r].call(n.exports,n,n.exports,__webpack_require__);n.l=true;return n.exports}__webpack_require__.m=e;__webpack_require__.c=t;__webpack_require__.d=function(e,t,r){if(!__webpack_require__.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};__webpack_require__.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};__webpack_require__.t=function(e,t){if(t&1)e=__webpack_require__(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var r=Object.create(null);__webpack_require__.r(r);Object.defineProperty(r,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)__webpack_require__.d(r,n,function(t){return e[t]}.bind(null,n));return r};__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};__webpack_require__.d(t,"a",t);return t};__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=0)})([function(e,t,r){r(2);e.exports=r(1)},function(e,t){function changeCategory(){console.warn("This method is deprecated please use shopCategory.changeOrder()");return shopCategory.changeOrder()}function toggleCategories(){console.warn("This method is deprecated please use shopCategory.toggle()");return shopCategory.toggle()}function select_content(e,t){console.warn("This method is deprecated please use shopConfig.selectContent()");return shopConfig.selectContent(e,t)}function restartContentRequest(){console.warn("This method is deprecated please use shopConfig.restartContent()");return shopConfig.restartContent()}function contentRequest(){console.warn("This method is deprecated please use shopConfig._contentRequest()");return shopConfig._contentRequest()}function reloadPage(e){console.warn("This method is deprecated please use shopConfig.reloadPage()");return shopConfig.reloadPage(e)}function reloadLanguage(e){console.warn("This method is deprecated please use shopConfig.reloadLanguage()");return shopConfig.reloadLanguage(e)}function changeCouponType(){console.warn("This method is deprecated please use shopCoupon.changeType()");return shopCoupon.changeType()}function template_width_change(e){console.warn("This method is deprecated please use shopEmailHub.changeWidth()");return shopEmailHub.changeWidth(e)}function template_width_pluss(e){console.warn("This method is deprecated please use shopEmailHub.widthPlus()");return shopEmailHub.widthPlus(e)}function template_padding_change(e){console.warn("This method is deprecated please use shopEmailHub.changePadding()");return shopEmailHub.changePadding(e)}function template_padding_pluss(e){console.warn("This method is deprecated please use shopEmailHub.paddingPlus()");return shopEmailHub.paddingPlus(e)}function addrow_pluss(e){console.warn("This method is deprecated please use shopEmailHub.plusRow()");return shopEmailHub.plusRow(e)}function add_blocks(e,t){console.warn("This method is deprecated please use shopEmailHub.addBlock()");return shopEmailHub.addBlock(e,t)}function select_block(e){console.warn("This method is deprecated please use shopEmailHub.selectBlock()");return shopEmailHub.selectBlock(e)}function $_(e){console.warn("This method is deprecated please use shopHelper.getElement()");return shopHelper.getElement(e)}function $F_(e){console.warn("This method is deprecated please use shopHelper.getValue()");return shopHelper.getValue(e)}function Round(e,t){console.warn("This method is deprecated please use shopHelper.round()");return shopHelper.round(e,t)}function isEmpty(e){console.warn("This method is deprecated please use shopHelper.isEmpty()");return shopHelper.isEmpty(e)}function isExistsExcludeAttrInEditAttr(){console.warn("This method is deprecated please use shopHelper.isExistsExcludeAttributes()");return shopHelper.isExistsExcludeAttributes()}function isCouponEditPage(){console.warn("This method is deprecated please use shopHelper.isCouponEditPage()");return shopHelper.isCouponEditPage()}function setDefaultSize(e,t,r){console.warn("This method is deprecated please use shopImage.setDefaultSize()");return shopImage.setDefaultSize(e,t,r)}function setOriginalSize(e){console.warn("This method is deprecated please use shopImage.setOriginalSize()");return shopImage.setOriginalSize(e)}function setManualSize(e){console.warn("This method is deprecated please use shopImage.setManualSize()");return shopImage.setManualSize(e)}function deleteFoto(e,t){console.warn("This method is deprecated please use shopImage.delete()");return shopImage.delete(e,t)}function verifyStatus(e,t,r,n,o){console.warn("This method is deprecated please use shopOrderAndOffer.verifyStatus()");return shopOrderAndOffer.verifyStatus(e,t,r,n,o)}function updateOrderSubtotalValue(){console.warn("This method is deprecated please use shopOrderAndOffer.updateOrderSubtotal()");return shopOrderAndOffer.updateOrderSubtotal()}function updateOrderTotalValue(){console.warn("This method is deprecated please use shopOrderAndOffer.updateOrderTotal()");return shopOrderAndOffer.updateOrderTotal()}function order_tax_calculate(){console.warn("This method is deprecated please use shopOrderAndOffer.calculateTax()");return shopOrderAndOffer.calculateTax()}function getOrderData(){console.warn("This method is deprecated please use shopOrderAndOffer.getData()");return shopOrderAndOffer.getData()}function getListOrderItems(){console.warn("This method is deprecated please use shopOrderAndOffer.getList()");return shopOrderAndOffer.getList()}function addOrderItemRow(){console.warn("This method is deprecated please use shopOrderAndOffer.addItemRow()");return shopOrderAndOffer.addItemRow()}function addOrderTaxRow(){console.warn("This method is deprecated please use shopOrderAndOffer.addTaxRow()");return shopOrderAndOffer.addTaxRow()}function loadProductInfoRowOrderItem(e,t,r){console.warn("This method is deprecated please use shopOrderAndOffer.loadProductInfo()");return shopOrderAndOffer.loadProductInfo(e,t,r)}function updateBillingShippingForUser(e){console.warn("This method is deprecated please use shopOrderAndOffer.updateShippingForUser()");return shopOrderAndOffer.updateShippingForUser(e)}function setBillingShippingFields(e){console.warn("This method is deprecated please use shopOrderAndOffer._setShipping()");return shopOrderAndOffer._setShipping(e)}function addAttributValue2(e,t){console.warn("This method is deprecated please use shopProductAttribute.addSecondValue()");return shopProductAttribute.addSecondValue(e,t)}function addAttributValue(){console.warn("This method is deprecated please use shopProductAttribute.addValue()");return shopProductAttribute.addValue()}function editAttributeExtendParams(e){console.warn("This method is deprecated please use shopProductAttribute.editExtendParams()");return shopProductAttribute.editExtendParams(e)}function deleteListAttr(){console.warn("This method is deprecated please use shopProductAttribute.deleteList()");return shopProductAttribute.deleteList()}function selectAllListAttr(e){console.warn("This method is deprecated please use shopProductAttribute.selectList()");return shopProductAttribute.selectList(e)}function updateEanForAttrib(){console.warn("This method is deprecated please use shopProductCommon.updateEan()");return shopProductCommon.updateEan()}function reloadProductExtraField(e){console.warn("This method is deprecated please use shopProductCommon.reloadExtraField()");return shopProductCommon.reloadExtraField(e)}function ShowHideEnterProdQty(e){console.warn("This method is deprecated please use shopProductCommon.toggleQuantity()");return shopProductCommon.toggleQuantity(e)}function deleteFileProduct(e,t){console.warn("This method is deprecated please use shopProductCommon.deleteFile()");return shopProductCommon.deleteFile(e,t)}function price_types_add_new_option(){console.warn("This method is deprecated please use shopProductFreeAttribute.addOption()");return shopProductFreeAttribute.addOption()}function facp_delete_adv_option(e){console.warn("This method is deprecated please use shopProductFreeAttribute.deleteOption()");return shopProductFreeAttribute.deleteOption(e)}function free_attributte_recalcule(e){console.warn("This method is deprecated please use shopProductFreeAttribute.recalculate()");return shopProductFreeAttribute.recalculate(e)}const r=e=>{console.warn("This method is deprecated please use shopProductFreeAttribute.keyUp()");return shopProductFreeAttribute.keyUp(e)};function showHideParamForPriceTypeQTYSelect(){console.warn("Method togglePriceType(for functional `Price per consignment type`) was deleted.")}function getSelectView(){console.warn("This method is deprecated please use shopProductFreeAttribute.getSelectView()");return shopProductFreeAttribute.getSelectView()}function facpAddLastNewRow(e){console.warn("This method is deprecated please use shopProductFreeAttribute.addLastRow()");return shopProductFreeAttribute.addLastRow()}function facpHideTexts(e){console.warn("This method is deprecated please use shopProductFreeAttribute.hideText()");return shopProductFreeAttribute.hideText(e)}function facpShowTexts(e){console.warn("This method is deprecated please use shopProductFreeAttribute.showText()");return shopProductFreeAttribute.showText(e)}function updateVariablesNames(e,t){console.warn("This method is deprecated please use shopProductFreeAttribute.updateName()");return shopProductFreeAttribute.updateName(e,t)}function getCountOfVariables(){console.warn("This method is deprecated please use shopProductFreeAttribute.getVariablesCount()");return shopProductFreeAttribute.getVariablesCount()}function product_images_request(e,t,r){console.warn("This method is deprecated please use shopProductImage.productRequest()");return shopProductImage.productRequest(e,t,r)}function setImageFromFolder(e,t){console.warn("This method is deprecated please use shopProductImage.setImageFromFolder()");return shopProductImage.setImageFromFolder(e,t)}function SqueezeBox_init(e,t){console.warn("This method is deprecated please use shopProductImage.squeezeBoxInit()");return shopProductImage.squeezeBoxInit(e,t)}function updatePrice(e,t){console.warn("This method is deprecated please use shopProductPrice.update()");return shopProductPrice.update(e,t)}function addNewPrice(){console.warn("This method is deprecated please use shopProductPrice.add()");return shopProductPrice.add()}function delete_add_price(e){console.warn("This method is deprecated please use shopProductPrice.delete()");return shopProductPrice.delete(e)}function productAddPriceupdateValue(e){console.warn("This method is deprecated please use shopProductPrice.update()");return shopProductPrice.updateNewPrice(e)}function reloadAddPriceValue(){console.warn("This method is deprecated please use shopProductPrice.reload()");return shopProductPrice.reload()}function add_to_list_relatad(e){console.warn("This method is deprecated please use shopProductRelated.add()");return shopProductRelated.add(e)}function delete_related(e){console.warn("This method is deprecated please use shopProductRelated.delete()");return shopProductRelated.delete(e)}function releted_product_search(e,t){console.warn("This method is deprecated please use shopProductRelated.search()");return shopProductRelated.search(e,t)}function add_usergroups_prices_addNewPrice_list(e){console.warn("This method is deprecated please use shopProductUserGroup.addPriceList()");return shopProductUserGroup.addPriceList(e)}function add_usergroups_prices_delete_add_price_list(e,t){console.warn("This method is deprecated please use shopProductUserGroup.deletePriceList()");return shopProductUserGroup.deletePriceList(e,t)}function add_usergroups_prices_productAddPriceupdateValue_list(e,t){console.warn("This method is deprecated please use shopProductUserGroup.updatePriceValueList()");return shopProductUserGroup.updatePriceValueList(e,t)}function add_usergroups_prices_updatePrice_list(e,t,r){console.warn("This method is deprecated please use shopProductUserGroup.updatePriceList()");return shopProductUserGroup.updatePriceList(e,r)}function add_usergroups_prices_productAddPriceupdateValue(e){console.warn("This method is deprecated please use shopProductUserGroup.updatePriceValue()");return shopProductUserGroup.updatePriceValue(e)}function add_usergroups_prices_delete_add_price(e){console.warn("This method is deprecated please use shopProductUserGroup.deletePrice()");return shopProductUserGroup.deletePrice(e)}function add_usergroups_prices_addNewPrice(){console.warn("This method is deprecated please use shopProductUserGroup.addPrice()");return shopProductUserGroup.addPrice()}function add_usergroups_prices_updatePrice(e,t){console.warn("This method is deprecated please use shopProductUserGroup.updatePrice()");return shopProductUserGroup.updatePrice(e,t)}function updateAllVideoFileField(){console.warn("This method is deprecated please use shopProductVideo.updateAll()");return shopProductVideo.updateAll()}function changeVideoFileField(e){console.warn("This method is deprecated please use shopProductVideo.changeVideo()");return shopProductVideo.changeVideo(e)}function deleteVideoProduct(e){console.warn("This method is deprecated please use shopProductVideo.delete()");return shopProductVideo.delete(e)}function deleteFotoLabel(e,t){console.warn("This method is deprecated please use shopProductLabel.delete()");return shopProductLabel.delete(e,t)}function addShippingPrice(){console.warn("This method is deprecated please use shopShipping.addPrice()");return shopShipping.addPrice()}function deleteShippingPrice(e){console.warn("This method is deprecated please use shopShipping.deletePrice()");return shopShipping.deletePrice(e)}function delete_shipping_weight_price_row(e){console.warn("This method is deprecated please use shopShipping.deletePrice()");return shopShipping.deletePrice(e)}function otherDeliveryAddress(e){console.warn("This method is deprecated please use shopUser.anotherDeliveryAddress()");return shopUser.anotherDeliveryAddress(e)}function getState(){console.warn("This method is deprecated please use shopStates.getState()");return shopStates.getState()}function see_states(){console.warn("This method is deprecated please use shopStates.see_states()");return shopStates.see_states()}function getState2(){console.warn("This method is deprecated please use shopStates.getState2()");return shopStates.getState2()}function delete_from_package(e){console.warn("This method is deprecated please use shopOrder.delete_from_package()");return shopOrder.delete_from_package(e)}function getPackagesProductsJson(){console.warn("This method is deprecated please use shopOrder.getPackagesProductsJson()");return shopOrder.getPackagesProductsJson()}function setSavedPackages(e){console.warn("This method is deprecated please use shopOrder.setSavedPackages()");return shopOrder.setSavedPackages(e)}function orderedit_package_add(e){console.warn("This method is deprecated please use shopOrder.orderedit_package_add()");return shopOrder.orderedit_package_add(e)}function productPackage_dragover_handler(e){console.warn("This method is deprecated please use shopOrder.productPackage_dragover_handler()");return shopOrder.productPackage_dragover_handler(e)}function productPackage_dragstart_handler(e){console.warn("This method is deprecated please use shopOrder.productPackage_dragstart_handler()");return shopOrder.productPackage_dragstart_handler(e)}function productPackage_drop_handler(e){console.warn("This method is deprecated please use shopOrder.productPackage_drop_handler()");return shopOrder.productPackage_drop_handler(e)}},function(e,t,r){"use strict";r.r(t);class ShopHelper{getElement(e){return document.getElementById(e)}getValue(e){let t=this.getElement(e);switch(t.type){case"select-one":return t.options[t.selectedIndex].value;case"radio":case"checkbox":return t.checked;case"text":case"password":case"textarea":case"hidden":return t.value;default:return t.innerHTML}}round(e,t){let r=parseFloat(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString();return isNaN(r)?0:r}isEmpty(e){let t=/\S/;return t.test(e)?0:1}isExistsExcludeAttributes(){return document.querySelector("#eafa_attr_ids")?true:false}isCouponEditPage(){let e=document.querySelector("input#coupon_code");let t=document.querySelector('input[name="finished_after_used"]');return e&&t?true:false}delete(e){let t=document.querySelector(e);if(t){t.remove();return true}return false}showHideByChecked(e,t,r="block"){let n=document.querySelector(t);if(n){n.style.display=e.checked?r:"none";return true}return false}showAlertMessage(e,t,r){if(e&&t&&e==t){alert(r)}}sendAjax(e,t=null,r=null){if(this.haveAjax){this.ajaxRequest.abort()}this.ajaxRequest=fetch(e,{method:"POST",body:JSON.stringify(t),cache:"no-cache"}).then(e=>e.json()).then(e=>r);this.haveAjax=1;return this.ajaxRequest}deleteMarkUp(e){if(e){try{document.querySelector(e).remove();return true}catch(t){console.error("Can`t find markupSelector - "+e)}}return false}dataTransform(e){var t=[];for(var r in e){var n=encodeURIComponent(r);var o=encodeURIComponent(e[r]);t.push(n+"="+o)}t=t.join("&");return t}saveorder(e,t,r){if(this.checkAll_button(e,t,r)){window.stop()}}checkAll_button(e,t,r){console.warn("window.checkAll_button() is deprecated without a replacement!");t=t?t:"saveorder";var n,o;for(n=0;n<=e;n++){o=document.adminForm["cb"+n];if(o){o.checked=true}}Joomla.submitform(t)}_afterAjax(){}getFormData(e){var t={};var r=null;var n=typeof e;if(n=="element"||n=="object"&&e.className=="cart-product__form"){r=e}else if(n=="string"){r=document.querySelector(e)}else if(n=="object"&&e.name){r=document.querySelector('form[name="'+e.name+'"]')}var o=r.querySelectorAll("[name]");if(o){o.forEach(function(e,r){if(e&&e.name&&e.value&&(e.type=="radio"||e.type=="checkbox")){if(e.checked){var n=e.name.replace(/jshop_attr_id/,"attr");n=n.replace(/freeattribut/,"freeattr");t[n]=e.value}}else if(e&&e.name&&e.value){var n=e.name.replace(/jshop_attr_id/,"attr");n=n.replace(/freeattribut/,"freeattr");t[n]=e.value}})}return t}}var n=new ShopHelper;class attributes_ShopAttributes{constructor(){document.addEventListener("DOMContentLoaded",function(){if(n.isExistsExcludeAttributes()){let e=document.querySelector("#eafa_attr_ids");if(e){e.addEventListener("change",function(e){let t=[this.value];let r=document.querySelectorAll("#eafa_tr .attr_values");if(r){r.forEach(function(e){let r=e.dataset.id;if(r){let n=t.includes(r)?true:false;n?e.classList.remove("hide"):e.classList.add("hide")}})}})}}})}}var o=new attributes_ShopAttributes;class ShopCategory{changeOrder(){let e=document.querySelector("#category_parent_id");if(e){let t=e.value;let r=`index.php?option=com_jshopping&controller=categories&task=sorting_cats_html&catid=${t}&ajax=1`;fetch(r,{method:"GET"}).then(e=>{return e.text()}).then(e=>{let t=document.querySelector("#ordering");if(t){t.innerHTML=e}})}}toggle(){let e=document.querySelector("input[name=allcats]:checked");if(e){let t=document.querySelector("#tr_categorys");if(t){let r=+e.value?"none":"inherit";t.style.display=r}}}}var a=new ShopCategory;class ShopSearch{searchEnterKeyPress(e,t){if(e.keyCode==13){t.form.submit()}}searchRelatedEnterKeyPress(e,t,r){if(e.keyCode==13){shopProductRelated.search(t,r)}}}var d=new ShopSearch;class ShopConfig{selectContent(e,t){let r=document.getElementById("content_link_id");let n=document.querySelector(`#remove_${r.value} i`);if(r){let n=document.getElementById(r.value);let o=document.getElementById(`label_${r.value}`);if(n){n.value=e}if(o){o.innerHTML=t}}if(n){n.classList.remove("hidden")}}restartContent(){this.reloadLanguage("");this.reloadPage(0);this._contentRequest()}_contentRequest(){let e=document.getElementById("content_link_id").value;let t="";if(e!=""){t=document.getElementById(`${e}_type`).value}let r={filterOpts:[document.getElementById("content_page").value,document.getElementById("content_language").value,t]};fetch("index.php?option=com_jshopping&controller=config&task=get_content",{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:shopHelper.dataTransform(r)}).then(e=>e.text()).then(e=>{let t=document.querySelector("#result");if(t){t.innerHTML=e}})}reloadPage(e){document.getElementById("content_page").value=e;this._contentRequest()}reloadLanguage(e){document.getElementById("content_page").value=0;document.getElementById("content_language").value=e;this._contentRequest()}storageDeleteUploadsAlert(e,t){if(!confirm(t)){let t=document.querySelector("#"+e);if(t){t.value=0}}}removeContent(e,t){let r=document.querySelector(`#${e}_${t}`);let n=document.querySelector(`#label_${e}_${t}`);let o=document.querySelector(`#remove_${e}_${t} i`);if(r){r.value=0}if(n){n.innerHTML=""}if(o){o.classList.add("hidden")}}}var i=new ShopConfig;class coupon_ShopCoupon{constructor(){document.addEventListener("DOMContentLoaded",function(e){if(n.isCouponEditPage()){let e=document.querySelector("#create-for-each-user");if(e){e.addEventListener("change",function(){let e=document.querySelector(".forUserIdRow");let t=document.querySelector(".couponRowEl");let r=this.checked?"none":"inherit";if(e){e.style.display=r}if(t){t.style.display=r}})}}})}changeType(){let e=document.querySelector("input[name=coupon_type]:checked");let t=document.querySelector("#ctype_percent");let r=document.querySelector("#ctype_value");if(e&&+e.value){t.style.display="none";r.style.display="inline-block"}else{t.style.display="inline-block";r.style.display="none"}}}var l=new coupon_ShopCoupon;class ShopEmailHub{constructor(){this.id=0}changeWidth(e){document.querySelector("#preview").style.width=parseInt(e.value)+"px"}widthPlus(e){let t=document.querySelector("#template_width").value;document.querySelector("#template_width").value=parseInt(t)+parseInt(e);document.querySelector("#preview").style.width=t+"px"}changePadding(e){document.querySelector("#preview").style.padding=parseInt(e.value)+"px"}paddingPlus(e){let t=document.querySelector("#template_padding").value;document.querySelector("#template_padding").value=parseInt(t)+parseInt(e);document.querySelector("#preview").style.padding=t+"px"}plusRow(e){document.querySelector("#blocks").value=parseInt(document.querySelector("#blocks").value)+parseInt(e)}addBlock(e,t){this.id++;let r=`<div class='row_view' style='height: ${t} px' id='block_id_${this.id}' onClick='select_row(this)'>`;for(let n=1;n<=e;n++){r=r+`<div  class='block_item block_view' style='width: ${100/e} %; height: ${t} px' id='block_id_${this.id}X${n}' onClick='shopEmailHub.selectBlock(this)'>#block</div>`}r+="</div>";r=r+"</div>";document.querySelector("#preview_padding").innerHTML+=r}selectBlock(e){let t=e.id;let r=document.querySelector("#selected_row").value;let n=document.querySelector("#selected_block").value;t=t.substr(0,t.indexOf("X"));if(r!="")document.querySelector(r).classList.remove("selected_row");if(n!="")document.querySelector(n).classList.remove("selected_block");document.querySelector("#selected_row").value=t;document.querySelector("#selected_block").value=e.id;document.querySelector(t).classList.add("selected_row");document.querySelector(e.id).classList.add("selected_block")}}var u=new ShopEmailHub;class ShopImage{setDefaultSize(e,t,r){shopHelper.getElement(r+"_width_image").value=e;shopHelper.getElement(r+"_height_image").value=t;shopHelper.getElement(r+"_width_image").disabled=true;shopHelper.getElement(r+"_height_image").disabled=true}setOriginalSize(e){shopHelper.getElement(e+"_width_image").disabled=true;shopHelper.getElement(e+"_height_image").disabled=true;shopHelper.getElement(e+"_width_image").value=0;shopHelper.getElement(e+"_height_image").value=0}setManualSize(e){shopHelper.getElement(e+"_width_image").disabled=false;shopHelper.getElement(e+"_height_image").disabled=false}delete(e,t){let r,n;switch(t){case"category":r="index.php?option=com_jshopping&controller=categories&task=delete_foto&catid="+e;n="#foto_category";break;case"payments":r="index.php?option=com_jshopping&controller=payments&task=delete_foto&payment_id="+e;n="#foto_payments";break;case"shipping":r="index.php?option=com_jshopping&controller=shippings&task=delete_foto&shipping_id="+e;n="#foto_shippings";break;case"product":r="index.php?option=com_jshopping&controller=products&task=delete_foto&id="+e;n="#foto_product_"+e;let o=document.querySelector(n);if(o){o.remove()}break;case"manafacturer":r="index.php?option=com_jshopping&controller=manufacturers&task=delete_foto&id="+e;n="#image_manufacturer";break;case"attribut":r="index.php?option=com_jshopping&controller=attributesvalues&task=delete_foto&id="+e;n="#image_attrib_value";break;case"productfield":r="index.php?option=com_jshopping&controller=productfieldvalues&task=delete_foto&id="+e;n="#image_productfield_value";break;default:return}fetch(r,{method:"GET"}).then(e=>{return e.text()}).then(()=>{let e=document.querySelector(n);if(e){e.style.display="none"}})}}var c=new ShopImage;class ShopShipping{constructor(){this.number=0}addPrice(){this.number++;let e=`\n            <tr id="shipping_weight_price_row_${this.number}">\n                <td>`+document.querySelector(".hidden #condition").parentNode.innerHTML+`\n                </td>\n                <td>\n                    <input type="text" class="inputbox form-control" name="shipping_price[]" />\n                </td>\n                <td>\n                    <input type="text" class="inputbox form-control" name="shipping_package_price[]" />\n                </td>\n                <td style="text-align:center">\n                    <a class="btn btn-micro" href="#" onclick="shopShipping.deletePrice(${this.number});return false;">\n                        <i class="icon-delete"></i>\n                    </a>\n                </td>\n            </tr>\n        `;document.querySelector("#table_shipping_weight_price tbody").insertAdjacentHTML("beforeend",e)}deletePrice(e){document.querySelector(`#shipping_weight_price_row_${e}`).remove()}setNumber(e){this.number=e}}var s=new ShopShipping;class ShopUser{anotherDeliveryAddress(e){let t=document.querySelector(".endes");if(t){if(e){t.removeAttribute("disabled")}else{t.setAttribute("disabled","disabled")}}}}var p=new ShopUser;class order_and_offer_ShopOrderAndOffer{constructor(){this.ajax=null}verifyStatus(e,t,r,o,a){if(o==0){let o=n.getValue("select_status_id"+t);if(o==e){alert(r);return}else{let e=n.getElement("order_check_id_"+t).checked?"&notify=1":"";location.href=`index.php?option=com_jshopping&controller=orders&task=update_status&js_nolang=1&order_id=${t}&order_status=`+o+a+e}}else{let o=n.getValue("order_status");if(o==e){alert(r);return}else{let e=n.getElement("notify").checked?"&notify=1":"&notify=0";let r=n.getElement("include").checked?"&include=1":"&include=0";location.href=`index.php?option=com_jshopping&controller=orders&task=update_one_status&js_nolang=1&order_id=${t}&order_status=`+o+e+r+"&comments="+encodeURIComponent(n.getValue("comments"))}}}updateOrderSubtotal(){let e=0;let t=/product_item_price\[(\d+)\]/i;let r=document.querySelectorAll("input[name^=product_item_price]");if(r){r.forEach(function(r){let n=t.exec(r.getAttribute("name"));let o=n[1];let a=parseFloat(r.value.replace(",","."));let d=document.querySelector(`input[name="product_quantity[${o}]"]`);let i=parseFloat(d.value.replace(",","."));let l=document.querySelector(`input[name="product_one_time_price[${o}]"]`);if(l){var u=parseFloat(l.value.replace(",","."))}else{var u=0}if(isNaN(a))a=0;if(isNaN(i))i=0;e+=a*i+u})}let n=document.querySelector("input[name=order_subtotal]");if(n){n.value=e}this.updateOrderTotal();this.calculateTax()}updateOrderTotal(){let e=0;let t=parseFloat(document.querySelector("input[name=order_subtotal]").value.replace(",","."));let r=parseFloat(document.querySelector("input[name=order_discount]").value.replace(",","."));let n=parseFloat(document.querySelector("input[name=order_shipping]").value.replace(",","."));let o=parseFloat(document.querySelector("input[name=order_package]").value.replace(",","."));let a=parseFloat(document.querySelector("input[name=order_payment]").value.replace(",","."));if(isNaN(t))t=0;if(isNaN(r))r=0;if(isNaN(n))n=0;if(isNaN(o))o=0;if(isNaN(a))a=0;e=t-r+n+o+a;let d=document.querySelector("#display_price");if(d&&d.value==1){let t=document.querySelectorAll("input[name^=tax_value]");if(t){t.forEach(function(t){let r=parseFloat(t.value.replace(",","."));if(isNaN(r))r=0;e+=r})}}document.querySelector("input[name=order_total]").value=e}calculateTax(){var e=window.shopOrderAndOffer;let t=document.querySelector("#user_id");let r=e.getList();let o=e.getData();let a="index.php?option=com_jshopping&controller=offer_and_order&task=loadtaxorder";let d={data_order:JSON.stringify(o),product:JSON.stringify(r)};if(t&&t.value)a+=`&admin_load_user_id=${t.value}`;fetch(a,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:n.dataTransform(d),cache:"no-cache"}).then(e=>e.json()).then(t=>{let r=document.querySelectorAll('input[name="tax_percent[]"]');if(r.length>0){r.forEach(function(e){e.parentElement.parentElement.remove()})}for(let e=0;e<t.length;e++){let r=`\n                    <tr class='bold'>\n                        <td class="right">\n                           `+Joomla.JText._("COM_SMARTSHOP_PLUS_TAX")+` <input type="text" class="small3 form-control" name="tax_percent[]" value="${t[e]["tax"]}"/> %\n                        </td>\n                        <td class="left">\n                            <input type="text" class="small3 form-control" name="tax_value[]" onkeyup="shopOrderAndOffer.updateOrderTotal();" value="${t[e]["value"]}"/> â‚¬ \n                        </td>\n                    </tr>\n                `;document.querySelector("#row_button_add_tax").insertAdjacentHTML("beforebegin",r)}e.updateOrderTotal()})}getData(){let e={};document.querySelectorAll(".jshop_address input, .jshop_address select").forEach(function(t){let r=t.getAttribute("name");e[r]=t.value});let t=document.querySelector('select[name="order_delivery_times_id"]');let r=document.querySelector('select[name="shipping_method_id"]');let n=document.querySelector('select[name="payment_method_id"]');let o=document.querySelector('input[name="order_shipping"]');let a=document.querySelector('input[name="order_discount"]');let d=document.querySelector('select[name="display_price"]');let i=document.querySelector('input[name="order_payment"]');let l=document.querySelector('input[name="order_package"]');let u=document.querySelector('input[name="currency_id"]');let c=document.querySelector('input[name="coupon_code"]');let s=document.querySelector("#user_id");let p=document.querySelector('select[name="lang"]');if(t){e["order_delivery_times_id"]=t.value}if(r){e["shipping_method_id"]=r.value}if(n){e["payment_method_id"]=n.value}if(o){e["order_shipping"]=o.value.replace(",",".")}if(a){e["order_discount"]=a.value.replace(",",".")}if(d){e["display_price"]=d.value.replace(",",".")}if(i){e["order_payment"]=i.value.replace(",",".")}if(l){e["order_package"]=l.value.replace(",",".")}if(u){e["currency_id"]=u.value}if(c){e["coupon_code"]=c.value}if(s){e["user_id"]=s.value}if(p){e["lang"]=p.value}return e}getList(){let e=end_number_order_item+1;let t={};for(let r=1;r<=e;r++){let e=document.querySelector(`input[name="product_id[${r}]"]`);if(!e)continue;let n=e.value;if(!n)continue;let o={product_id:n};let a=document.querySelector(`input[name="product_freeattributes[${r}]"]`);let d=document.querySelector(`input[name="product_item_price[${r}]"]`);let i=document.querySelector(`input[name="product_one_time_price[${r}]"]`);let l=document.querySelector(`input[name="product_attributes[${r}]"]`);let u=document.querySelector(`input[name="delivery_times_id[${r}]"]`);let c=document.querySelector(`input[name="product_quantity[${r}]"]`);let s=document.querySelector(`input[name="order_item_id[${r}]"]`);let p=document.querySelector(`input[name="product_name[${r}]"]`);let _=document.querySelector(`input[name="product_ean[${r}]"]`);let m=document.querySelector(`input[name="thumb_image[${r}]"]`);let h=document.querySelector(`input[name="vendor_id[${r}]"]`);let f=document.querySelector(`input[name="weight[${r}]"]`);let g=document.querySelector(`input[name="product_tax[${r}]"]`);if(a){o["product_freeattributes"]=a.value}if(d){o["product_item_price"]=d.value.replace(",",".")}if(i){o["one_time_cost"]=i.value.replace(",",".")}if(l){o["product_attributes"]=l.value}if(u){o["delivery_times_id"]=u.value}if(c){o["product_quantity"]=c.value.replace(",",".")}if(s){o["order_item_id"]=s.value}if(p){o["product_name"]=p.value}if(_){o["product_ean"]=_.value}if(m){o["thumb_image"]=m.value}if(h){o["vendor_id"]=h.value}if(g){o["product_tax"]=g.value}if(f){o["weight"]=f.value}t[r]=o}return t}addItemRow(){end_number_order_item++;let e=end_number_order_item;let t="index.php?option=com_jshopping&controller=offer_and_order&task=addItemRow&id="+e;if(this.ajax)this.ajax.abort();fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.text()).then(e=>{let t=document.querySelector("#list_order_items tbody");if(t){t.innerHTML+=e}})}addTaxRow(){let e=`\n            <tr>\n                <td class="right">\n                    <input type="text" class="small3 form-control" name="tax_percent[]"/> %\n                </td>\n                <td class="left">\n                    <input type="text" class="small3 form-control" name="tax_value[]" onkeyup="shopOrderAndOffer.updateOrderTotal();"/>\n                </td>\n            </tr>\n        `;let t=document.querySelector("#row_button_add_tax");if(t){t.insertAdjacentHTML("beforebegin",e)}}loadProductInfo(e,t,r){let n=`index.php?option=com_jshopping&controller=products&task=loadproductinfo&product_id=${e}&currency_id=${r}&ajax=1`;fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{let r=document.querySelector(`input[name="product_item_price[${t}]"]`);let n=document.querySelector(`input[name="delivery_times_id[${t}]"]`);let o=document.querySelector(`input[name="product_quantity[${t}]"]`);let a=document.querySelector(`input[name="product_name[${t}]"]`);let d=document.querySelector(`input[name="product_tax[${t}]"]`);let i=document.querySelector(`input[name="product_ean[${t}]"]`);let l=document.querySelector(`input[name="thumb_image[${t}]"]`);let u=document.querySelector(`input[name="product_id[${t}]"]`);let c=document.querySelector(`input[name="vendor_id[${t}]"]`);let s=document.querySelector(`input[name="weight[${t}]"]`);let p=document.querySelector(`input[name="product_one_time_price[${t}]"]`);if(r){r.value=e.product_price}if(n){n.value=e.delivery_times_id}if(o){o.value="1.00"}if(a){a.value=e.product_name}if(d){d.value=e.product_tax}if(i){i.value=e.product_ean}if(l){l.value=e.thumb_image}if(u){u.value=e.product_id}if(c){c.value=e.vendor_id}if(s){s.value=e.product_weight}if(p){p.value=e.one_time_cost}this.updateOrderSubtotal()})}updateShippingForUser(e){if(e){let t={user_id:e};if(this.ajax)this.ajax.abort();this.ajax=fetch(userinfo_link,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{this._setShipping(e)})}else{this._setShipping(userinfo_fields)}}_setShipping(e){for(let t in e){document.querySelector(`.jshop_address [name="${t}"]`).value=e[t]}}}var _=new order_and_offer_ShopOrderAndOffer;class ShopProductCommon{constructor(){this.triggers={html:"",secondHtml:"",events:[],secondEvents:[]}}updateEan(){let e=document.querySelector("#attr_ean");let t=document.querySelector("#product_ean");if(e&&t){e.value=t.value}}reloadExtraField(e){let t="";let r=document.querySelector("#category_id").selectedOptions;if(r){for(let e of r){if(e.value){t+="&cat_id[]="+e.value}}}let n=`index.php?option=com_jshopping&controller=products&task=product_extra_fields&product_id=${e+t}&ajax=1`;fetch(n,{method:"GET"}).then(e=>e.text()).then(e=>{let t=document.querySelector("#extra_fields_space");if(t){t.innerHTML=e}})}toggleAttrQuantityAdd(e,t){let r=e?"none":"inherit";let n=document.querySelector(`#block_enter_attr_qty_${t}`);if(n){n.style.display=r}}toggleAttrQuantity(e){let t=e?"none":"inherit";let r=document.querySelector("#block_enter_attr_qty");if(r){r.style.display=t}}toggleQuantity(e){let t=e?"none":"inherit";let r=document.querySelector("#block_enter_prod_qty");if(r){r.style.display=t}}deleteFile(e,t){let r=`index.php?option=com_jshopping&controller=products&task=delete_file&id=${e}&type=${t}`;fetch(r,{method:"GET"}).then(e=>e.text()).then(r=>{if(t=="demo"){let t=document.querySelector(`#product_demo_${e}`);if(t){t.innerHTML=""}}if(t=="file"){let t=document.querySelector(`#product_file_${e}`);if(t){t.innerHTML=""}}if(r=="1"){let t=document.querySelector(`.rows_file_prod_${e}`);t.style.display="none"}})}}var m=new ShopProductCommon;class attribute_ShopProductAttribute{constructor(){this.number=100500}addSecondValue(e,t){let r=this;let n=0;let o=document.querySelector(`#attr_ind_id_tmp_${e}`).value;let a=document.querySelector(`#attr_ind_${e}_${o}`);if(a){alert(lang_attribute_exist);return 0}if(o=="0"){alert(lang_error_attribute);return 0}let d=document.querySelector(`#list_attr_value_ind_${e}[id*=attr_ind_row_]`);if(d){n=d.length++}let i=document.querySelector(`#attr_ind_id_tmp_${e}`).children;let l=Array.from(i).map(e=>+e.value);let u=document.querySelector(`#attr_ind_id_tmp_${e}`).selectedOptions[0].text;let c=document.querySelector(`#attr_price_mod_tmp_${e}`).value;let s=document.querySelector(`#attr_ind_price_tmp_${e}`).value;let p=document.querySelector(`#attr_ind_expiration_date_tmp_${e}`).value;let _=document.querySelector(`#attr_ind_weight_tmp_${e}`);let h=0;if(_){h=_.value}if(t){for(let t of l){let r=document.querySelector(`#attr_ind_${e}_${t}`);if(r!==null){alert(Joomla.JText._("COM_SMARTSHOP_HIDDEN_ATTR_ADD_ERROR"));return}}}let f=`<tr id='attr_ind_row_${e}_${o}' class='ui-sortable-handle'>`;t=`<input type='hidden' id='attr_ind_${e}_${o}' name='attrib_ind_id[]' value='${e}'>`;let g=`<input type='hidden' name='attrib_ind_value_id[]' value='${o}'>`;let y="";if(o!=0&&attrib_images[o]!=""){y=`<img src="${folder_image_attrib}/${attrib_images[o]}" style="margin-right:5px;" width="16" height="16" class="img_attrib">`}f+=`<td><span class='icon-menu' aria-hidden='true'></span></td>`;f+="<td>"+t+g+y+u+"</td>";f+=`\n            <td>\n                <input type='text' class='small3' name='attrib_ind_price_mod[]' value='${c}'>\n            </td>\n            <td>\n                <input type='text' class='small3' name='attrib_ind_price[]' value='${s}'>\n            </td>\n            <td class='priceTypeSelect'></td>\n            <td>\n                <input type='text' class='small3 ' name='attrib_ind_weight[]' value='${h}'>\n            </td>\n\t\t\t<td>\n                <input type='date' class='small3 ' name='attrib_ind_expiration_date[]' value='${p}'>\n            </td>\t\n            <td>\n                <a class='btn btn-micro' href='#' onclick="document.querySelector('#attr_ind_row_${e}_${o}').remove();return false;">\n                    <i class="icon-delete"></i>\n                </a>\n                <input type='hidden' name='product_independ_attr_sorting[]' value='${n}'>\n            </td>\n        </tr>\n        `;document.querySelector(`#list_attr_value_ind_${e} tbody`).insertAdjacentHTML("beforeEnd",f);m.triggers.secondEvents.forEach(function(t){t.call(r,e)})}addValue(){attr_tmp_row_num++;let e=0;let t=0;let r="";let n="";let o="";let a=0;let d={};let i="";let l={};let u=0;let c=[];let s=[];let p=1;let _=attrib_ids.length;let h=0;let f={};let g=this;for(let r=0;r<_;r++){c[r]=0;e=attrib_ids[r];t="value_id"+e;l[e]=[];u=0;let n=document.querySelector(`#${t}`).selectedOptions;if(n){for(let t of n){let r=t.value;let n=t.text;if(r){l[e][u]={text:n,value:r};u++}}}if(l[e].length==0){l[e][0]={text:"-",value:"0"}}else{a++}s[r]=l[e].length;p=p*s[r]}let y=document.querySelectorAll("#list_attr_value tbody tr:nth-child(1) input[type=hidden]");if(y.length>0){for(let t=0;t<_;t++){e=attrib_ids[t];if(y[t].value==0){if(l[e][0].value!=0){alert(lang_error_attribute);return 0}}if(y[t].value!=0){if(l[e][0].value==0){alert(lang_error_attribute);return 0}}}}if(a==0){alert(lang_error_attribute);return 0}let v=document.querySelector(`#only_one_hidden_${e}`);if(v!==null){if(l[e].length>1){alert(Joomla.JText._("COM_SMARTSHOP_HIDDEN_ATTR_ADD_ERROR"));return}for(let t in attrib_exist){if(attrib_exist[t][e]){alert(Joomla.JText._("COM_SMARTSHOP_HIDDEN_ATTR_ADD_ERROR"));return}}}let S=[];for(let t=0;t<p;t++){S[t]=[];for(let r=0;r<_;r++){e=attrib_ids[r];u=c[r];S[t][r]=u}h=0;for(let e=0;e<_;e++){if(e==h){c[h]++;if(c[h]>=s[h]){c[h]=0;h++}}}}let q=document.querySelector("#attr_price")?document.querySelector("#attr_price").value:null;let b=document.querySelector("#attr_old_price")?document.querySelector("#attr_old_price").value:null;let w=document.querySelector("#attr_product_price_type")?document.querySelector("#attr_product_price_type").value:null;let P=document.querySelector('input[class^="qtydiscount"]:checked')?document.querySelector('input[class^="qtydiscount"]:checked').value:null;let $=document.querySelector("#attr_weight_volume_units")?document.querySelector("#attr_weight_volume_units").value:null;let k=document.querySelector("#attr_basic_price_unit_id")?document.querySelector("#attr_basic_price_unit_id").value:null;let x=document.querySelector("#low_stock_attr_notify_number");let A=document.querySelector("#attr_product_tax_id");let E=document.querySelector("#attr_labels");let T=document.querySelector("#attr_no_return");let O=document.querySelector("#attr_price_per_consignment_basic_price_unit_id");let I=document.querySelectorAll('#list_attr_value tr[id*="attr_row_"]');let L=document.querySelector('input[class^="publish_editor_pdf"]:checked')?document.querySelector('input[class^="publish_editor_pdf"]:checked').value:null;let C=document.querySelector("#attr_weight")?document.querySelector("#attr_weight").value:null;let R=document.querySelector("#attr_expiration_date")?document.querySelector("#attr_expiration_date").value:null;let N=document.querySelector("#attr_ean")?document.querySelector("#attr_ean").value:null;let H=document.querySelector("#attr_count")?document.querySelector("#attr_count").value:null;let U=document.querySelector("#attr_unlimited")&&document.querySelector("#attr_unlimited").checked?"checked":"";let F=U?'style="display:none;"':"";let j=x&&parseInt(x.value)?parseInt(x.value):0;let B=document.querySelector("#low_stock_attr_notify_status")&&document.querySelector("#low_stock_attr_notify_status").checked?"checked":"";let M=document.querySelector("#attr_factory")?document.querySelector("#attr_factory").value:null;let D=document.querySelector("#attr_storage")?document.querySelector("#attr_storage").value:null;let V=0;if(A){V=A.value}let J=document.querySelector("#attr_product_manufacturer_id")?document.querySelector("#attr_product_manufacturer_id").value:null;let G=document.querySelector("#attr_production_time")?document.querySelector("#attr_production_time").value:null;let z=document.querySelector("#attr_delivery_times_id")?document.querySelector("#attr_delivery_times_id").value:null;let Q=0;if(E){Q=E.value}let X=T&&T.checked?1:0;let K=document.querySelector("#attr_quantity_select")?document.querySelector("#attr_quantity_select").value:null;let W=document.querySelector("#attr_max_count_product")?document.querySelector("#attr_max_count_product").value:null;let Y=document.querySelector("#attr_min_count_product")?document.querySelector("#attr_min_count_product").value:null;let Z=document.querySelector("#attr_consignment_product_is_add_price")&&document.querySelector("#attr_consignment_product_is_add_price").checked?1:0;let ee=document.querySelector("#attr_is_activated_price_per_consignment_upload")&&document.querySelector("#attr_is_activated_price_per_consignment_upload").checked?1:0;let te=0;if(O){te=O.value}let re=0;let ne=document.querySelector("#attr_buy_price");if(ne){re=ne.value}let oe=I.length-1;let ae=oe;let de=0;let ie=this._getPricePerConsigmentDataOfDependAttr();let le=parseInt(document.querySelector('[name="attr_equal_steps"]:checked')?document.querySelector('[name="attr_equal_steps"]:checked').value:false);let ue=document.querySelector("#attr_media_title")?document.querySelector("#attr_media_title").value:null;let ce=document.querySelector("#attr_media_link")?document.querySelector("#attr_media_link").value:null;let se=document.querySelector("#attr_media_preview")?document.querySelector("#attr_media_preview").value:null;let pe=document.querySelector("#attr_media_file")?document.querySelector("#attr_media_file").value:null;var _e="";for(let t=0;t<p;t++){d={};r=`<tr id='attr_row_${attr_tmp_row_num}'><td><span class='icon-menu' aria-hidden='true'></span></td>`;let a=this._getHtmlPricePerConsigmentDataOfDependAttr(ie,ae);let c=this._getPricePerConsigmentUploadDataOfDependAttr(ae);let s=this._getHtmlPricePerConsigmentDataOfDependAttr(c,null);let p=this._getAttrPriceUsergroup(ae);for(let o=0;o<_;o++){e=attrib_ids[o];u=S[t][o];f=l[e][u];n=`<input type='hidden' name='attrib_id[${e}][]' value='${f.value}'>`;i="";_e="";if(f.value!=0&&attrib_images[f.value]!=""){i=`<img src="${folder_image_attrib}/${attrib_images[f.value]}" style="margin-right:5px;" width="16" height="16" class="img_attrib">`}if(f.value!=0){if(document.querySelector(".col_attr_"+e)&&document.querySelector(".col_attr_"+e).style.display=="none"){document.querySelectorAll(".col_attr_"+e).forEach(function(e){e.style.display="revert"})}}else{if(document.querySelector(".col_attr_"+e)&&document.querySelector(".col_attr_"+e).style.display=="none"){_e="display:none;"}}r+="<td class='col_attr_"+e+"' style='"+_e+"'>"+n+i+f.text+"</td>";d[e]=f.value}o=`<input type='text' class="form-control" name='attrib_price[]' value='${q}'>`;r+=`<td>${o}</td>`;r+=m.triggers.html;if(use_stock){o=`<div id='block_enter_attr_qty_${attr_tmp_row_num}' ${F}><input type='text' class="form-control" name='attr_count[]' value='${H}'></div>\n\t\t\t\t<div><input type='hidden'  name='attr_unlimited[${ae}]' value='0' />\n\t\t\t\t    <input type='checkbox' class="form-check-input" name='attr_unlimited[${ae}]' ${U} value='1' onclick='shopProductCommon.toggleAttrQuantityAdd(this.checked, ${attr_tmp_row_num})'  />Unlimited</div>`;r+=`<td>${o}</td>`;o=`\n                    <input type='hidden' name='low_stock_attr_notify_status[${ae}]' value='0'>\n                    <input type='checkbox' class="form-check-input" style='width: 20px; margin-bottom: 14px;' ${B} name='low_stock_attr_notify_status[${ae}]' value='1'>\n                    <input type='number' class="form-control" name='low_stock_attr_notify_number[${ae}]' value='${j}'>`;r+=`<td>${o}</td>`}o=`<input type='text' class="form-control" name='attr_ean[]' value='${N}'>`;r+=`<td>${o}</td>`;o=`<input type='text' class="form-control" name='attr_weight[]' value='${C}'>`;r+=`<td>${o}</td>`;o=`<input type='date' class="form-control" name='attr_expiration_date[]' value='${R}'>`;r+=`<td>${o}</td>`;r+=`<td><input type='number' class="form-control" name='attr_production_time[]' value='${G}'></td>`;if(use_basic_price=="1"){o=`<input type='text' class="form-control" name='attr_weight_volume_units[]' value='${$}'>`;r+=`<td>${o}</td>`}o=`<input type='text' class="form-control" name='attrib_old_price[]' value='${b}'>`;r+=`<td>${o}</td>`;if(use_bay_price=="1"){o=`<input type='text' class="form-control" name='attrib_buy_price[]' value='${re}'>`;r+=`<td>${o}</td>`}r+=`\n                    <td></td>\n                    <td>\n                        <input type='checkbox' class='ch_attr_delete form-check-input' value='${attr_tmp_row_num}'>\n                        <input type='hidden' name='product_attr_sorting[]' value='${attr_tmp_row_num}'>\n                        <input type='hidden' name='product_attr_id[]' value='0'>\n                        \n                        <input type='hidden' name='attr_product_price_type[]' value='${w}'>\n                        <input type='hidden' name='attr_qtydiscount[]' value='${P}'>\n                        <input type='hidden' name='attr_factory[]' value='${M}'>\n                        <input type='hidden' name='attr_storage[]' value='${D}'>\n                        <input type='hidden' name='attr_product_tax_id[]' value='${V}'>\n                        <input type='hidden' name='attr_product_manufacturer_id[]' value='${J}'>\n                        <input type='hidden' name='attr_delivery_times_id[]' value='${z}'>\n                        <input type='hidden' name='attr_labels[]' value='${Q}'>\n                        <input type='hidden' name='attr_no_return[]' value='${X}'>\n                        <input type='hidden' name='attr_quantity_select[]' value='${K}'>\n                        <input type='hidden' name='attr_max_count_product[]' value='${W}'>\n                        <input type='hidden' name='attr_min_count_product[]' value='${Y}'>\n                        <input type='hidden' name='attr_basic_price_unit_id[]' value='${k}'>\n                        <input type='hidden' name='attr_add_price_unit_id[]' value='${te}'>\n                        <input type='hidden' name='attr__equal_steps[]' value='${le}'>\n\t\t\t\t\t\t<input type='hidden' name='attr_publish_editor_pdf[]' value='${L}'>\n\n                        <input type='hidden' name='attr__consignment_product_is_add_price[]' value='${Z}'>\n                        <input type='hidden' name='attr__is_activated_price_per_consignment_upload[]' value='${ee}'>\n                        <input type='hidden' name='attr_media[${ae}][media][][title]' value='${ue}'>\n                        <input type='hidden' name='attr_media[${ae}][media][][link]' value='${ce}'>\n                        <input type='hidden' name='attr_media[${ae}][media][][preview]' value='${se}'>\n                        <input type='hidden' name='attr_media[${ae}][media][][file]' value='${pe}'>\n                        <input type='hidden' name='attr_media[${ae}][media][][is_main]' value='1'>\n                        ${a.join("")}\n                        ${s.join("")}\n                        ${p.join("")}\n                    </td>\n                </tr>\n            `;let h=0;for(let t in attrib_exist){let r=1;for(let n=0;n<_;n++){e=attrib_ids[n];if(attrib_exist[t][e]!=d[e])r=0}if(r){h=1;break}}if(!h){let e=document.querySelector("#list_attr_value tbody");if(e){e.insertAdjacentHTML("beforeend",r)}attrib_exist[attr_tmp_row_num]=d;attr_tmp_row_num++;de++}++ae}if(de==0){alert(lang_attribute_exist);return 0}m.triggers.events.forEach(function(e){e.call(g,de)});return 1}editExtendParams(e){window.open("index.php?option=com_jshopping&controller=products&task=edit&product_attr_id="+e,"windowae","width=1000, height=760, scrollbars=yes,status=no,toolbar=no,menubar=no,resizable=yes,location=yes")}deleteList(){document.querySelector("#ch_attr_delete_all").checked=false;let e=document.querySelectorAll(".ch_attr_delete");if(e){e.forEach(function(e){if(e.checked){let t=e.value;if(document.querySelector(`#attr_row_${t}`))document.querySelector(`#attr_row_${t}`).remove();delete attrib_exist[t]}})}}selectList(e){let t=document.querySelectorAll(".ch_attr_delete");if(t){t.forEach(function(t){t.checked=e})}}batchEdit(e){let t=[];let r=document.querySelector(e).querySelectorAll(".ch_attr_delete:checked");if(r.length<=0){return alert(Joomla.JText._("COM_SMARTSHOP_NO_DEPENDENT_ATTRIBUTE_SELECTED"))}Array.prototype.forEach.call(r,e=>{let r=e.parentElement;let n=r.querySelector("[name^=product_attr_id]");let o=r.querySelector("[name^=ext_attribute_product_id]");if(n&&o){if(n.value>0&&o.value>0){t.push({productAttrId:n.value,extAttrProductId:o.value})}}});if(t.length>=1){window.open("/administrator/index.php?option=com_jshopping&controller=products&task=displayDependAttrEditList&ids="+encodeURIComponent(JSON.stringify(t)),"_blank").focus()}else{return alert(Joomla.JText._("COM_SMARTSHOP_NO_DEPENDENT_ATTRIBUTE_SELECTED"))}}_getHtmlPricePerConsigmentDataOfDependAttr(e,t){let r=[];if(e){Object.keys(e).forEach(function(n){let o=n;if(t!==null){o+="["+t+"][]"}else{o+="[]"}let a=`<input type='hidden' name="${o}" value="~~">`;let d=e[n];if(d!==null){Object.keys(d).forEach(function(e){let t=a.replace("~~",d[e]);r.push(t)})}else{let e=a.replace("~~","");r.push(e)}})}return r}_getAttrPriceUsergroup(e){let t={};let r=[];let n=document.querySelector("#attribs-page");let o=`attrDependUsergroup[${e}]`;t.add_usergroups_prices_usergroup=[];t.add_usergroups_prices_product_price=[];t.add_usergroups_prices_product_price2=[];t.add_usergroups_prices_product_old_price=[];var a=document.querySelectorAll(".usergroup_price");if(a.length>0){t.add_usergroup_price=1}else{t.add_usergroup_price=null}if(t.add_usergroup_price){var d=n.querySelectorAll("#attr_div_hidden_add_new_usergroup_price .usergroup_price");var i=0;d.forEach(function(e){t.add_usergroups_prices_usergroup[i]=e.querySelector("[id^=attr_depend_add_usergroups_prices_usergroup]").value||"";t.add_usergroups_prices_product_price[i]=e.querySelector("[id^=attr_add_usergroups_prices_product_price_list]").value||"";t.add_usergroups_prices_product_price2[i]=e.querySelector("[id^=attr_add_usergroups_prices_product_price2_list]")&&e.querySelector("[id^=attr_add_usergroups_prices_product_price2_list]").value||"";t.add_usergroups_prices_product_old_price[i]=e.querySelector("[id^=attr_add_usergroups_prices_product_old_price]").value||"";r.push(`<input type="hidden" name="${o}[${i}][add_usergroup_price]" value="${t.add_usergroup_price[i]}">`);r.push(`<input type="hidden" name="${o}[${i}][add_usergroups_prices_usergroup]" value="${t.add_usergroups_prices_usergroup[i]}">`);r.push(`<input type="hidden" name="${o}[${i}][add_usergroups_prices_product_price]" value="${t.add_usergroups_prices_product_price[i]}">`);r.push(`<input type="hidden" name="${o}[${i}][add_usergroups_prices_product_price2]" value="${t.add_usergroups_prices_product_price2[i]}">`);r.push(`<input type="hidden" name="${o}[${i}][add_usergroups_prices_product_old_price]" value="${t.add_usergroups_prices_product_old_price[i]}">`);let n={};var a=document.querySelector("#attribs-page");let d=`${o}[${i}][add_usergroups_prices_product_is_add_price]`;let l=`${o}[${i}][add_usergroups_prices_product_add_discount][]`;let u=`${o}[${i}][add_usergroups_prices_quantity_start][]`;let c=`${o}[${i}][add_usergroups_prices_quantity_finish][]`;let s=`${o}[${i}][add_usergroups_prices_product_add_price][]`;let p=`${o}[${i}][add_usergroups_prices_start_discount][]`;let _=`${o}[${i}][add_usergroups_prices_add_price_unit_id]`;let m=e.querySelector("[id^=attr_add_usergroups_prices_add_price_unit_id]").value||0;let h=e.querySelector("[id^=attr_add_usergroups_prices_product_is_add_price]").value||0;n[l]=e.querySelectorAll("[name^=attr_add_usergroups_prices_product_add_discount]")||"";n[u]=e.querySelectorAll("[name^=attr_add_usergroups_prices_quantity_start]")||"";n[c]=e.querySelectorAll("[name^=attr_add_usergroups_prices_quantity_finish]")||"";n[s]=e.querySelectorAll("[name^=attr_add_usergroups_prices_product_add_price]")||"";n[p]=e.querySelectorAll("[name^=attr_add_usergroups_prices_start_discount]")||"";Object.keys(n).forEach(function(e){let t=n[e];if(t!==""){Object.keys(t).forEach(function(n){let o=t[n];let a=o.value||"";r.push(`<input type="hidden" name="${e}" value="${a}">`)})}else{r.push(`<input type="hidden" name="${e}" value="''">`)}});r.push(`<input type="hidden" name="${_}" value="${m}">`);r.push(`<input type="hidden" name="${d}" value="${h}">`);i++})}return r}_getPricePerConsigmentUploadDataOfDependAttr(e){let t=`attr__nativeProgressUploads[prices][updates][${e}][from_item]`;let r=`attr__nativeProgressUploads[prices][updates][${e}][to_item]`;let n=`attr__nativeProgressUploads[prices][updates][${e}][percent]`;let o=`attr__nativeProgressUploads[prices][updates][${e}][price]`;let a=`attr__nativeProgressUploads[prices][updates][${e}][calculated_price]`;let d={};let i={};i[t]=[];i[r]=[];i[n]=[];i[o]=[];i[a]=[];var l=document.querySelector("#attribs-page #attrnativeProgressUploadsAddPrices");d[t]=l.querySelectorAll("input.attrnativeProgressUploadsAddPrices__from-el")||null;d[r]=l.querySelectorAll("input.attrnativeProgressUploadsAddPrices__to-el")||null;d[n]=l.querySelectorAll("input.attrnativeProgressUploadsAddPrices__percent-el")||null;d[o]=l.querySelectorAll("input.attrnativeProgressUploadsAddPrices__price-el")||null;d[a]=l.querySelectorAll("input.attrnativeProgressUploadsAddPrices__calculated-price-el")||null;Object.keys(d).forEach(function(e){let t=d[e];if(t!==null){Object.keys(t).forEach(function(r){let n=t[r];let o=n.value||null;i[e].push(o)})}else{i[e].push(null)}});return i}_getPricePerConsigmentDataOfDependAttr(){let e={};let t={attr__consignment_quantity_start:[],attr__consignment_quantity_finish:[],attr__consignment_product_add_discount:[],attr__consignment_product_add_price:[],attr__consignment_start_discount:[]};var r=document.querySelector("#attribs-page #attr_consignment_table_add_price");e.attr__consignment_quantity_start=r.querySelectorAll('input[name^="attr_consignment_quantity_start"]')||null;e.attr__consignment_quantity_finish=r.querySelectorAll('input[name^="attr_consignment_quantity_finish"]')||null;e.attr__consignment_product_add_discount=r.querySelectorAll('input[name^="attr_consignment_product_add_discount"]')||null;e.attr__consignment_product_add_price=r.querySelectorAll('input[name^="attr_consignment_product_add_price"]')||null;e.attr__consignment_start_discount=r.querySelectorAll('input[name^="attr_consignment_start_discount"]')||null;Object.keys(e).forEach(function(r){let n=e[r];if(n!==null){Object.keys(n).forEach(function(e){let o=n[e];let a=o.value||null;t[r].push(a)})}else{t[r].push(null)}});return t}_getPricePerGropDataOfDependAttr(){let e={};let t={attr__usergroup_price:[],attr__usergroups_prices_usergroup:[],attr__usergroups_prices_product_price:[],attr__usergroups_prices_product_price2:[],attr__usergroups_prices_product_old_price:[],attr__usergroups_prices_add_price_unit_id:[],attr__usergroups_prices_product_is_add_price:[]};var r=document.querySelector("#attribs-page #attr_div_hidden_add_new_usergroup_price");e.attr__usergroups_prices_usergroup=r.querySelectorAll('input[name^="attr_depend_add_usergroups_prices_usergroup"]')||null;e.attr__usergroup_price=r.querySelectorAll('input[name^="attr_add_usergroups_prices_product_price"]')||null;e.attr__consignment_product_add_discount=r.querySelectorAll('input[name^="attr_consignment_product_add_discount"]')||null;e.attr__consignment_product_add_price=r.querySelectorAll('input[name^="attr_consignment_product_add_price"]')||null;e.attr__consignment_start_discount=r.querySelectorAll('input[name^="attr_consignment_start_discount"]')||null;Object.keys(e).forEach(function(r){let n=e[r];if(n!==null){Object.keys(n).forEach(function(e){let o=n[e];let a=o.value||null;t[r].push(a)})}else{t[r].push(null)}});return t}addUserGroupPrice(){this.number++;let e=document.querySelector("#attr_div_hidden_add_new_usergroup_price_temp").content.cloneNode(true);var t=document.createElement("div");t.appendChild(e);var r=t.innerHTML;r=r.replaceAll("100500",this.number);const n=document.createElement("template");n.innerHTML=r;let o=document.querySelector(".attr_usergroup_price");let a=o.querySelector(".attr_div_hidden_add_new_usergroup_price");a.appendChild(document.importNode(n.content,true));document.querySelector("#attr_add_usergroup_price").value=1}removeGroupRow(e){document.querySelector(".row_groups_"+e).remove();var t=document.querySelectorAll(".usergroup_price");if(t.length>0){document.querySelector("#attr_add_usergroup_price").value=1}else{document.querySelector("#attr_add_usergroup_price").value=0}}separatePost(e){e.insertAdjacentHTML("beforeend",'<input type="hidden" name="ajax" value="1" />');let t=FormDataJson.toJson(e);let r={};e.disabled=true;var n=document.getElementById("spinner_loading_block");n.style.visibility="visible";r={data:t};let o={error:[]};fetch("/administrator/index.php?option=com_jshopping&controller=products&task=save",{method:"POST",body:JSON.stringify(r),headers:{"Content-type":"appliation/json; charset=utf-8"}}).then(e=>e.json()).then(e=>{var t=e.product_id?e.product_id:0;var r=e.error?e.error:0;var n=e.msg?e.msg:"";var o=e.product_attr_id?e.product_attr_id:0;window.location.href="index.php?option=com_jshopping&controller=products&task=ajaxRedirectProductPage&product_id="+t+"&error="+r+"&msg="+n+"&product_attr_id="+o})}}var h=new attribute_ShopProductAttribute;class ShopProductCharacteristics{switchSelectToMultButDontTouchAlreadyMult(e,t=10){let r=document.querySelectorAll('body select[name^="productfields"]');if(r){r.forEach(function(r){let n=r.dataset;let o=n.isMultipleInitially;if(n.isMultipleInitially===undefined){n.isMultipleInitially=o=r.multiple?1:0}if(o!=1){if(e){r.setAttribute("size",t);r.setAttribute("multiple",e)}else{r.removeAttribute("size");r.removeAttribute("multiple")}}})}}}var f=new ShopProductCharacteristics;class freeattribute_ShopProductFreeAttribute{constructor(){this.html=null}addOption(){let e=document.querySelector(".formula_name_empty_block");let t=document.querySelector(".formula_name_empty_block ~ .buttonAdd");if(t&&e){t.insertAdjacentHTML("beforebegin",e.innerHTML)}}deleteOption(e){let t=document.querySelector(`#adv_options_${e}`);if(t){t.remove()}}keyUp(e){if(window.id_time_out!=undefined)clearTimeout(window.id_time_out);window.id_time_out=setTimeout(()=>{this.recalculate(e)},750)}togglePriceType(){console.warn("Method togglePriceType(for functional `Price per consignment type`) was deleted.")}getSelectView(){let e=this;let t="index.php?option=com_jshopping&controller=free_attribute_calcule_price&task=getProductAttrPriceTypeSelect";fetch(t,{method:"POST"}).then(e=>e.text()).then(t=>{if(!e.html){m.triggers.secondHtml+=t;e.html=t}m.triggers.secondEvents[m.triggers.secondEvents.length]=(e=>{let r=document.querySelector(`#attrib_ind_price_type_tmp_${e}`);let n=document.querySelector(`#attr_ind_id_tmp_${e}`);if(r&&n){let o=n.selectedOptions[0].value;let a=document.querySelector(`#attr_ind_row_${e}_${o} .priceTypeSelect`);if(a){a.innerHTML=t}let d=document.querySelector(`#attr_ind_row_${e}_${o} select[name^="attrib_ind_price_type"]`);if(d){d.value=r.value}}})})}addLastRow(){let e=this.getVariablesCount();for(let r=1;r<=5;r++){let n=document.querySelector(`#facp_free_attr_column_${r}`);let o=n.children;let a=o[o.length-1].cloneNode(true);let d=e.length+1;let i=a.innerHTML;let l="var_"+e.length;let u=new RegExp(l,"g");let c=document.querySelector("#adminForm .addon-params").dataset.variableDefaultName+" "+d;i=i.replace(u,"var_"+d);a.innerHTML=i;n.insertAdjacentHTML("beforeend",`<div class="facp_free_attr_row-${d}">${a.innerHTML}</div>`);let s=document.querySelector(`#adminForm .facp_free_attr_row-${d}`);s.querySelector(".facp-variableName-edit__input").value=c;s.querySelector("select.facp_input").value=0;let p=n.querySelector(`input[name*=var_${d}]`);p.value="";p.setAttribute("placeholder","");s.querySelector(".facp_row_label__variable-name").innerHTML=c;s.querySelector(".var_descr__name").innerHTML="$var"+d;var t=s.querySelector(".fa-xmark").outerHTML;console.log(s.querySelector(".fa-xmark"));console.log(t);t=t.replace("removeRow("+e.length+")","removeRow("+d+")");s.querySelector(".fa-xmark").outerHTML=t;let _=n.querySelector(`.facp_free_attr_row-${d} .facp_row_label`);if(_){_.innerHTML=_.innerHTML.replace(e.length,d)}let m=n.querySelector(`.variable_${d}_minimum`);let h=n.querySelector(`.variable_${d}_default`);let f=n.querySelector(`.variable_${d}_maximum`);if(m){m.innerText=c+" "}if(h){h.innerText=c+" "}if(f){f.innerText=c+" "}}}hideText(e){let t=e.parentElement;t.querySelector(".facp_row_label__variable-name").style.display="none";t.querySelector(".facp-variableName-edit__input").style.display="block";t.querySelector(".facp-variableName-edit").style.display="block";t.querySelector(".var_descr").style.display="none"}showText(e){let t=e.closest(".facp_row_label");let r=t.querySelector(".facp_row_label__variable-name");let n=t.querySelector(".facp-variableName-edit__input").value;t.querySelector(".facp-variableName-edit").style.display="block";t.querySelector(".icon-pencil").style.display="block";t.querySelector(".var_descr").style.display="block";r.innerHTML=n;r.style.display="block";e.style.display="none";let o=e.getAttribute("name").match(/\[var\_(\w+)\]/)[1];this.updateName(o,n)}updateName(e,t){let r=document.querySelector("#adminForm");r.querySelector(`.variable_${e}_default`).innerHTML=t;r.querySelector(`.variable_${e}_minimum`).innerHTML=t;r.querySelector(`.variable_${e}_maximum`).innerHTML=t}getVariablesCount(){let e=document.querySelectorAll("#facp_free_attr_column_1 select[id*=paramsvariablesvar_]");return{findedElems:e,length:e.length}}removeRow(e){document.querySelector(".facp_free_attr_row-"+e).remove();document.querySelector(".variable_"+e+"_default").parentElement.parentElement.remove();document.querySelector(".variable_"+e+"_minimum").parentElement.parentElement.remove();document.querySelector(".variable_"+e+"_maximum").parentElement.parentElement.remove();if(document.querySelector(".facp_free_attr_row-"+e))document.querySelector(".facp_free_attr_row-"+e).remove()}}var g=new freeattribute_ShopProductFreeAttribute;class ShopProductImage{constructor(){this.ajax=null}productRequest(e,t,r){let n={position:e,filter:r};let o=document.querySelector("#product_images");o.innerHTML="";document.querySelector(".sbox-content-string").insertAdjacentHTML("beforeend",'<div id="product_images-overlay"></div>');fetch(t,{body:JSON.stringify(n),headers:{"Content-Type":"text/html"}}).then(e=>e.text()).then(e=>{document.querySelector("#product_images-overlay").remove();o.innerHTML=e;o.style.display="fade"})}setImageFromFolder(e,t){document.querySelector(`input[name='product_folder_image_${e}']`).value=t;document.querySelector("#sbox-overlay").click()}squeezeBoxInit(e,t){if(!e)e=640;if(!t)t=480;SqueezeBox.initialize();SqueezeBox.setOptions({size:{x:e,y:t}}).setContent("string","");SqueezeBox.applyContent(`<div id="product_images" style="display: none; height: ${t} px; overflow: scroll;"></div>`);document.querySelector(".sbox-content-string").insertAdjacentHTML("beforeend",'<div id="product_images-overlay"></div>')}}var y=new ShopProductImage;class price_ShopProductPrice{constructor(){this.number=0}update(e,t){if(event.keyCode!=9){let r=n.getElement("product_tax_id")[n.getElement("product_tax_id").selectedIndex].text;let o=/(\d*\.?\d*)%\)$/;let a,d;o.test(r);r=RegExp.$1;if(t){a=n.getValue("product_price");d=n.getElement("product_price2")}else{a=n.getValue("product_price2");d=n.getElement("product_price")}if(e==0){if(t){d.value=n.round(a/(1+r/100),product_price_precision)}else{d.value=n.round(a*(1+r/100),product_price_precision)}}else{if(t){d.value=n.round(a*(1+r/100),product_price_precision)}else{d.value=n.round(a/(1+r/100),product_price_precision)}}this.reload()}}updateByTax(e,t){if(event.keyCode!=9){let r=n.getElement("product_tax_id")[n.getElement("product_tax_id").selectedIndex].text;let o=/(\d*\.?\d*)%\)$/;let a,d,i,l;o.test(r);r=RegExp.$1;if(t){a=n.getElement("product_price");d=n.getValue("product_price2")}else{a=n.getElement("product_price2");d=n.getValue("product_price")}if(e==0){if(t){a.value=n.round(d*(1+r/100),product_price_precision)}else{a.value=n.round(d/(1+r/100),product_price_precision)}}else{if(t){a.value=n.round(d/(1+r/100),product_price_precision)}else{a.value=n.round(d*(1+r/100),product_price_precision)}}this.reload()}}add(e=""){if(consigment_rows_number===undefined){consigment_rows_number=0}consigment_rows_number++;e=e||"";let t=`\n            <tr id="${e}add_price_${consigment_rows_number}" data-consignment-id="${consigment_rows_number}">\n                <td>\n                    <input type = "text" class="small3 form-control w-50" name = "${e}quantity_start[]" id="${e}quantity_start_${consigment_rows_number}" />\n                </td>\n                <td>\n                    <input type = "text" class="small3 form-control w-50" name = "${e}quantity_finish[]" id="${e}quantity_finish_${consigment_rows_number}" />\n                </td>\n                <td>\n                    <input type = "text" class="small3 form-control w-50" name = "${e}product_add_discount[]" id="${e}product_add_discount_${consigment_rows_number}" onkeyup="shopPricePerConsigment.updateDiscount(${consigment_rows_number}, '${e}')" />\n                </td>\n                <td>\n                    <input type = "text" class="small3 form-control w-50" id="${e}product_add_price_${consigment_rows_number}" name="${e}product_add_price[]" onkeyup="shopPricePerConsigment.updatePrice(${consigment_rows_number}, '${e}')" />\n                    <input type = "hidden" id="${e}start_discount_${consigment_rows_number}" value = "" name="${e}start_discount[]" />\n                </td>\n                <td align="center">\n                    <a href="#" class="btn btn-micro" onclick="shopProductPrice.delete(${consigment_rows_number}, '${e}');return false;">\n                        <i class="icon-delete"></i>\n                    </a>\n                </td>\n            </tr>\n        `;document.querySelector(`#${e}table_add_price tbody`).insertAdjacentHTML("beforeend",t)}delete(e,t=""){document.querySelector(`#${t}add_price_${e}`).remove()}updateNewPrice(e){let t=document.querySelector("#product_price").value;let r=document.querySelector(`#product_add_discount_${e}`).value;if(t==""||price==""){return 0}document.querySelector(`#start_discount_${e}`).value=r}reload(){var e=document.querySelector("#product_price");let t=document.querySelector("#attr_price");if(e&&t){t.value=e.value}if(!e||e.value==""){return 0}}setNumber(e){if(e===undefined){e=this.number}else{this.number=e}}}var v=new price_ShopProductPrice;class priceperconsigment_ShopPricePerConsigment{updateAllPrices(){var e=document.querySelectorAll("#tr_add_price #table_add_price [data-consignment-id]");if(e){e.forEach(function(e){let t=e.dataset.consignmentId;let r=e.querySelector(`#product_add_discount_${t}`);if(r.value*1!=0){shopPricePerConsigment.updateDiscount(t)}else{shopPricePerConsigment.updatePrice(t)}})}}updatePrice(e,t=""){if(event.keyCode!=9){let r=`${t}product_add_discount_${e}`;let n=`${t}product_add_price_${e}`;let o=`${t}start_discount_${e}`;this.calcPrice(r,n,o)}}updateDiscount(e,t=""){if(event.keyCode!=9&&event.keyCode!=16){let r=`${t}product_add_discount_${e}`;let n=`${t}product_add_price_${e}`;let o=`${t}start_discount_${e}`;this.calcDiscount(r,n,o)}}updateUserGroupPriceList(e,t){if(event.keyCode!=9){let r=`${e}_${t}`;let n=`add_usergroups_prices_product_add_discount_list_${r}`;let o=`add_usergroups_prices_product_add_price_list_${r}`;let a=`add_usergroups_prices_start_discount_list_${r}`;let d=`add_usergroups_prices_product_price_list_${e}`;this.calcPrice(n,o,a,d)}}updateUserGroupDiscountList(e,t){if(event.keyCode!=9&&event.keyCode!=16){let r=`${e}_${t}`;let n=`add_usergroups_prices_product_add_discount_list_${r}`;let o=`add_usergroups_prices_product_add_price_list_${r}`;let a=`add_usergroups_prices_start_discount_list_${r}`;this.calcDiscount(n,o,a)}}updateUserGroupPriceSingle(e,t=""){let r=`${t}add_usergroups_prices_product_add_discount_${e}`;let n=`${t}add_usergroups_prices_product_add_price_${e}`;let o=`${t}add_usergroups_prices_start_discount_${e}`;this.calcPrice(r,n,o)}updateUserGroupDiscountSingle(e,t=""){let r=`${t}add_usergroups_prices_product_add_discount_${e}`;let n=`${t}add_usergroups_prices_product_add_price_${e}`;let o=`${t}add_usergroups_prices_start_discount_${e}`;this.calcDiscount(r,n,o)}calcDiscount(e,t,r){var o=n.getElement(e).value;var a=n.getElement(t);if(o==""){return 0}var d=n.getElement(r);d.value=o;a.value=0}calcPrice(e,t,r,o="product_price"){var a=n.getElement(o).value;var d=n.getElement(t).value;if(a==""||d==""){return 0}var i=n.getElement(r);var l=n.getElement(e);var u=100-d/a*100;i.value=u;l.value=0}}var S=new priceperconsigment_ShopPricePerConsigment;class ShopProductRelated{constructor(){this.lang=""}add(e){let t=document.querySelector("#list_related");let r=document.querySelector(`#serched_product_${e} .name`).innerHTML;let n=document.querySelector(`#serched_product_${e} .image`).innerHTML;let o=`\n            <div class="block_related" id="related_product_${e}">\n                <div class="block_related_inner">\n                    <div class="name">${r}</div>\n                    <div class="image">${n}</div>\n                    <div style="padding-top:5px;">\n                        <input type="button" class="btn btn-danger btn-small" value="${this.lang}" onclick="shopProductRelated.delete(${e})">\n                    </div>\n                    <input type="hidden" name="related_products[]" value="${e}"/>\n                </div>\n            </div>\n        `;if(t){t.insertAdjacentHTML("beforeend",o)}}delete(e){let t=document.querySelector(`#related_product_${e}`);if(t){t.remove()}}search(e,t){let r=document.querySelector("#related_search").value;let n=`index.php?option=com_jshopping&controller=products&task=search_related&start=${e}&no_id=${t}&text=${encodeURIComponent(r)}&ajax=1`;fetch(n).then(e=>e.text()).then(e=>{document.querySelector("#list_for_select_related").innerHTML=e})}setLang(e){this.lang=e}}var q=new ShopProductRelated;class usergroup_ShopProductUserGroup{constructor(){this.number=100500}addRowsPrice(e){let t=e.closest(".new_pr_but");let r=t.getAttribute("id").split("but_row_");this.addPriceList(r["1"])}addPriceList(e){this.number++;let t=`\n            <tr id="add_price_${this.number}">\n                <td>\n                    <input type="text" class="small3 form-control w-50" name="add_usergroups_prices_quantity_start_list[${e}][]" id="add_usergroups_prices_quantity_start_list_${e}_${this.number}" />\n                </td>\n                <td>\n                    <input type="text" class="small3 form-control w-50" name="add_usergroups_prices_quantity_finish_list[${e}][]" id="add_usergroups_prices_quantity_finish_list_${e}_${this.number}" />\n                </td>\n                <td>\n                    <input type="text" class="small3 form-control w-50" name="add_usergroups_prices_product_add_discount_list[${e}][]" id="add_usergroups_prices_product_add_discount_list_${e}_${this.number}" onkeyup="shopPricePerConsigment.updateUserGroupDiscountList(${e}, ${this.number})" />\n                </td>\n                <td>\n                    <input type="text" class="small3 form-control w-50" name="add_usergroups_prices_product_add_price_list[${e}][]" id="add_usergroups_prices_product_add_price_list_${e}_${this.number}" onkeyup="shopPricePerConsigment.updateUserGroupPriceList(${e},${this.number})" />\n                    <input type="hidden" name="add_usergroups_prices_start_discount_list[${e}][]" id="add_usergroups_prices_start_discount_list_${e}_${this.number}" />\n                </td>\n                <td align="center">\n                    <a href="#" class="btn btn-micro" onclick="shopProductUserGroup.deletePriceList(${this.number}); return false;">\n                        <i class="icon-delete"></i>\n                    </a>\n                </td>\n            </tr>\n        `;let r=document.querySelector(`#add_usergroups_prices_table_add_price_list_${e} tbody`);if(r){r.insertAdjacentHTML("beforeend",t)}}deletePriceList(e,t){if((e||e==0)&&(t||t==0)){document.querySelector(`#add_usergroups_prices_add_price_list_${e}_${t}`).remove()}else{document.querySelector(`#add_price_${e}`).remove()}}updatePriceList(e,t,r,n=""){if(event.keyCode!=9&&event.keyCode!=16){this.updatePrice(e,!r,t,n)}}deletePrice(e,t=""){document.querySelector(`#${t}add_usergroups_prices_add_price_${e}`).remove()}addPrice(e="#add_usergroups_prices_table_add_price tbody",t=""){this.number++;let r=`\n            <tr id="${t}add_usergroups_prices_add_price_${this.number}">\n                <td>\n                    <input type="text" class="small3 form-control w-50" name="${t}add_usergroups_prices_quantity_start[]" id="${t}add_usergroups_prices_quantity_start_${this.number}" />\n                </td>\n                <td>\n                    <input type="text" class="small3 form-control w-50" name="${t}add_usergroups_prices_quantity_finish[]" id="${t}add_usergroups_prices_quantity_finish_${this.number}"/>\n                </td>\n                <td>\n                    <input type="text" class="small3 form-control w-50" name="${t}add_usergroups_prices_product_add_discount[]" id="${t}add_usergroups_prices_product_add_discount_${this.number}" onkeyup="shopPricePerConsigment.updateUserGroupDiscountSingle(${this.number}, '${t}')" />\n                </td>\n                <td>\n                    <input type="text" class="small3 form-control w-50" id="${t}add_usergroups_prices_product_add_price_${this.number}" name="${t}add_usergroups_prices_product_add_price[]" onkeyup="shopPricePerConsigment.updateUserGroupPriceSingle(${this.number}, '${t}');"/>\n                    <input type="hidden" id="${t}add_usergroups_prices_start_discount_${this.number}" name="${t}add_usergroups_prices_start_discount[]" />\n                </td>\n                <td align="center">\n                    <a href="#" class="btn btn-micro" onclick="shopProductUserGroup.deletePrice(${this.number}, '${t}');return false;">\n                        <i class="icon-delete"></i>\n                    </a>\n                </td>\n            </tr>\n        `;let n=document.querySelector(e);if(n){n.insertAdjacentHTML("beforeend",r)}}updatePrice(e,t,r=null,o=""){let a,d;let i=n.getElement("product_tax_id")[n.getElement("product_tax_id").selectedIndex].text;let l=/(\d*\.?\d*)%\)$/;l.test(i);i=RegExp.$1;var u=r||r===0?"_list_"+r:"";if(t){a=n.getElement(o+"add_usergroups_prices_product_price"+u);d=n.getValue(o+"add_usergroups_prices_product_price2"+u)}else{a=n.getElement(o+"add_usergroups_prices_product_price2"+u);d=n.getValue(o+"add_usergroups_prices_product_price"+u)}var c=0;if(e==c){if(t){a.value=n.round(d*(1+i/100),product_price_precision)}else{a.value=n.round(d/(1+i/100),product_price_precision)}}else{if(t){a.value=n.round(d/(1+i/100),product_price_precision)}else{a.value=n.round(d*(1+i/100),product_price_precision)}}v.reload()}updateAllPrices(e){var t=document.querySelectorAll(`#add_usergroups_prices_table_add_price_list_${e} [data-group-id='${e}']`);if(t){t.forEach(function(t){var r=t.querySelector(`#add_usergroups_prices_product_add_discount_list_${e}_${t.dataset.rowNumber}`);if(r){if(r.value*1!=0){S.updateUserGroupDiscountList(e,t.dataset.rowNumber)}else{S.updateUserGroupPriceList(e,t.dataset.rowNumber)}}})}}updatePriceValueList(e,t){let r=document.querySelector(`#add_usergroups_prices_product_price_list_${t}`).value;let n=document.querySelector(`#add_usergroups_prices_product_add_discount_list_${t}_${e}`).value;if(r==""||n==""){return 0}document.querySelector(`#add_usergroups_prices_start_discount_list${t}_${e}`).value=n}updatePriceValue(e){let t=document.querySelector(`#add_usergroups_prices_product_price`).value;let r=document.querySelector(`#add_usergroups_prices_product_add_discount_${e}`).value;if(t==""||r==""){return 0}document.querySelector(`#add_usergroups_prices_start_discount_${e}`).value=r}addUserGroupPrice(){this.number++;let e=document.querySelector(" #div_hidden_add_new_usergroup_price").content.cloneNode(true);var t=document.createElement("div");t.appendChild(e);var r=t.innerHTML;r=r.replaceAll("100500",this.number);const n=document.createElement("template");n.innerHTML=r;let o=document.querySelector("#main-price");let a=o.querySelector(".usergoup_price_block");a.appendChild(document.importNode(n.content,true))}}var b=new usergroup_ShopProductUserGroup;class ShopProductVideo{updateAll(){let e=document.querySelectorAll(`table.admintable input[name^='product_insert_code_']`);if(e){e.forEach(e=>{this.changeVideo(e)})}}changeVideo(e){let t=e.checked;let r=e.closest("td:first");let n=r.querySelector("input[name^='product_video_']");let o=r.querySelector("textarea[name^='product_video_code_']");if(t){n.value="";n.style.display="none";o.style.display="block"}else{o.value="";o.style.display="none";n.style.display="block"}}delete(e){let t="index.php?option=com_jshopping&controller=products&task=delete_video&id="+e;fetch(t).then(e=>e.text()).then(()=>{document.querySelector(`#video_product_${e}`).style.display="none"})}}var w=new ShopProductVideo;class ShopProductLabel{delete(e,t){let r=`index.php?option=com_jshopping&controller=productlabels&task=delete_foto&id=${e}&lang=${t}`;fetch(r).then(e=>e.text()).then(()=>{let e=document.querySelector(`#image_block_${t}`);if(e){e.style.display="none"}})}}var P=new ShopProductLabel;class native_uploads_AdminShopNativeUploads{constructor(){this.countOfPricesRows=1;this._updateVariableCountOfPricesRows()}deletePriceRow(e,t=""){let r=`.${t}nativeProgressUploadsAddPrices__row[data-row-id="${e}"]`;return n.delete(r)}getCountOfPricesRows(){return document.querySelectorAll("#nativeProgressUploadsAddPrices .nativeProgressUploadsAddPrices__row").length}addPriceRow(e="#nativeProgressUploadsAddPrices .nativeProgressUploadsAddPrices__body",t=""){this.countOfPricesRows++;let r=document.querySelector(e);if(r){let e=`\n            <tr class="${t}nativeProgressUploadsAddPrices__row" data-row-id="${this.countOfPricesRows}">\n                <td class="${t}nativeProgressUploadsAddPrices__row-from">\n                    <input type="text" name="${t}nativeProgressUploads[prices][updates][${this.countOfPricesRows}][from_item]" value="0" class="small3 form-control w-50 ${t}nativeProgressUploadsAddPrices__row-item ${t}nativeProgressUploadsAddPrices__from-el">\n                </td>\n                <td class="${t}nativeProgressUploadsAddPrices__row-to">\n                    <input type="text" name="${t}nativeProgressUploads[prices][updates][${this.countOfPricesRows}][to_item]" value="0" class="small3 form-control w-50 ${t}nativeProgressUploadsAddPrices__row-item ${t}nativeProgressUploadsAddPrices__to-el">\n                </td>\n                <td class="${t}nativeProgressUploadsAddPrices__row-percent">\n                    <input type="text" name="${t}nativeProgressUploads[prices][updates][${this.countOfPricesRows}][percent]" value="0" class="small3 form-control w-50 ${t}nativeProgressUploadsAddPrices__row-item ${t}nativeProgressUploadsAddPrices__percent-el" onchange="AdminShopNativeUploads.clearPriceOrPercent(${this.countOfPricesRows}, true, '${t}'); AdminShopNativeUploads.updateCalculatedPrice(${this.countOfPricesRows}, this.value, '${t}');" value="0">\n                </td>\n                <td class="${t}nativeProgressUploadsAddPrices__row-price">\n                    <input type="text" name="${t}nativeProgressUploads[prices][updates][${this.countOfPricesRows}][price]" value="0" class="small3 form-control w-50 ${t}nativeProgressUploadsAddPrices__row-item ${t}nativeProgressUploadsAddPrices__price-el"  onchange="AdminShopNativeUploads.clearPriceOrPercent(${this.countOfPricesRows}, false, '${t}'); AdminShopNativeUploads.updateCalculatedPrice(${this.countOfPricesRows}, this.value, '${t}');" value="0">\n                </td>\n                <td class="${t}nativeProgressUploadsAddPrices__row-calculated-price display--none">\n                    <input type="text" name="${t}nativeProgressUploads[prices][updates][${this.countOfPricesRows}][calculated_price]" value="0" class="small3 form-control w-50 ${t}nativeProgressUploadsAddPrices__row-item ${t}nativeProgressUploadsAddPrices__calculated-price-el" value="0">\n                </td>\n                <td class="${t}nativeProgressUploadsAddPrices__row-delete">\n                    <a href="#" class="btn btn-micro" onclick="AdminShopNativeUploads.deletePriceRow(${this.countOfPricesRows}, '${t}'); return false;">\n                        <i class="icon-delete"></i>\n                    </a>\n                </td>\n            </tr>`;r.insertAdjacentHTML("beforeend",e)}}getRowElementById(e,t=""){var r=`.${t}nativeProgressUploadsAddPrices__row[data-row-id="${e}"]`;var n=document.querySelector(r);if(n){return n}}clearPriceOrPercent(e,t=true,r=""){var n=this.getRowElementById(e,r);var o=`.${r}nativeProgressUploadsAddPrices__price-el`;if(!t){o=`.${r}nativeProgressUploadsAddPrices__percent-el`}if(n){var a=n.querySelector(o);if(a){a.value=0}}}updateCalculatedPrice(e,t,r=""){var n=this.getRowElementById(e,r);if(n&&t){var o=n.querySelector(`.${r}nativeProgressUploadsAddPrices__calculated-price-el`);o.value=t}return false}_updateVariableCountOfPricesRows(){var e=this.getCountOfPricesRows();if(e){this.countOfPricesRows=e;return true}return false}}var $=new native_uploads_AdminShopNativeUploads;class ShopPage{constructor(){this.executeAfterDomReadyStack=[]}executeAfterDomReady(){var e=this.executeAfterDomReadyStack;if(e){document.addEventListener("DOMContentLoaded",function(t){e.forEach(function(e){if(e instanceof Function){e()}})})}}addToStackExecuteAfterDomReady(e){if(e){this.executeAfterDomReadyStack.push(e)}}}var k=new ShopPage;class ShopReview{constructor(){this.ajax=null}deleteAttachedFile(e,t){if(e&&t){var r="/administrator/index.php?option=com_jshopping&controller=reviews&task=ajaxDeleteAttachedFile&fileName="+e+"&id="+t;fetch(r).then(e=>e.json()).then(t=>{if(t.isDeleted){var r=document.querySelector('[data-file-id="'+e+'"]');if(r){r.remove()}}if(t.messages){var n=t.messages;var o=t.isDeleted?"message":"error";Joomla.renderMessages({[o]:[n["0"]]})}})}}}var x=new ShopReview;class ShopOrder{constructor(){this.number=100}deleteUploadedFile(e,t){if(e){var r="/administrator/index.php?option=com_jshopping&controller=orders&task=deleteUploadedFile&id="+e;return shopHelper.sendAjax(r,null,t)}}deleteUploadedFileAndDeleteMarkUp(e,t){if(e){this.deleteUploadedFile(e,function(e){if(e){var r=JSON.parse(e);if(r&&r.success&&t){shopHelper.deleteMarkUp(t)}}})}}generateNumber(){this.number++;return this.number}addNewUploadRow(e,t){if(e){var r=document.querySelector(e);if(r){var n=document.querySelector("#templateOfOrderUploadANewFile");var o=n.content.cloneNode(true);if(o){let n=o.querySelector(".orderItemUploadsItem");if(n){n.dataset.iteration=this.generateNumber();n.querySelector(".orderItemUploadsItem__delete").setAttribute("onclick","shopHelper.deleteMarkUp('"+e+' .orderItemUploadsItem[data-iteration="'+n.dataset.iteration+"\"]'); return false;");n.querySelector(".orderItemUploadsItem__qty").name="newUploads["+t+"][qty][]";n.querySelector(".orderItemUploadsItem__files").name="newUploads["+t+"][file][]";n.querySelector(".orderItemUploadsItem__description").name="newUploads["+t+"][description][]";r.appendChild(o)}}}}}delete_from_package(e){e.style.display="none";var t=e.parentNode.parentNode;var r=t.id.substring(t.id.indexOf("_")+1);if(document.getElementById(r)){document.getElementById(r).children[1].children[1].children[0].value=parseFloat(document.getElementById(r).children[1].children[1].children[0].value)+parseFloat(t.children[1].children[1].children[0].value);t.remove()}else{t.id=r;t.children[1].children[1].children[0].disabled=true;document.getElementById("shipping_packages").appendChild(t)}document.getElementById("shipping_packages_products").value=this.getPackagesProductsJson()}getPackagesProductsJson(){const e=document.getElementById("packages");var t=new Array;var r="{";for(let l=0;l<e.children.length;l++){var n=e.children[l].children[2].children[0];var o=e.children[l].id.substring(4);if(r[r.length-1]=="}")r=r+",";r=r+'"'+o+'":{';var a=new Array;for(let e=0;e<n.children.length;e++){var d=n.children[e].id;var i=d.substring(d.indexOf("_")+2);if(i.length>0){a[i]=parseFloat(n.children[e].children[1].children[1].children[0].value);if(r[r.length-1]!="{")r=r+",";r=r+'"'+i+'":'+parseFloat(n.children[e].children[1].children[1].children[0].value)}}r=r+"}";t[o]=a}r=r+"}";return r}setSavedPackages(e){let t=document.getElementById(e);if(t){t.value=this.getPackagesProductsJson()}}orderedit_package_add(e){package_index++;let t=document.getElementById("packages");if(t){if(t.children[0]){var r=t.children[0].cloneNode(true);if(r){r.id="pack"+package_index;r.children[0].children[2].innerHTML=package_index;r.children[0].children[4].children[0].value="";r.children[1].children[1].children[0].value="";r.children[1].children[3].children[0].value="";r.children[2].children[0].innerHTML="<p>"+e+"</p>";t.appendChild(r)}}else{var n=document.querySelector("#templateOfOrderPack");var o=n.content.cloneNode(true);var r=o.querySelector("#pack1");r.id="pack"+package_index;r.children[0].children[2].innerHTML=package_index;r.children[0].children[4].children[0].value="";r.children[1].children[1].children[0].value="";r.children[1].children[3].children[0].value="";r.children[2].children[0].innerHTML="<p>"+e+"</p>";t.appendChild(r)}}}productPackage_dragover_handler(e){e.preventDefault();e.dataTransfer.dropEffect="copy";e.dataTransfer.effectAllowed="copy"}productPackage_dragstart_handler(e){e.dataTransfer.setData("text/html",e.target.id);e.dataTransfer.dropEffect="copy";e.dataTransfer.effectAllowed="copy"}productPackage_change_quantity(e=this){if(typeof e.name!="undefined"&&e!=null){if(parseFloat(e.value)<0){e.value=0}var t=e.name.substring(e.name.indexOf("pq_")+3);var r=parseFloat(e.value);if(document.getElementById("p"+t)){var n=document.getElementById("p"+t).children[1].children[1].children[0];if(parseFloat(e.value)>=parseFloat(e.oldvalue)+parseFloat(n.value)){e.value=parseFloat(e.oldvalue)+parseFloat(n.value);n.value=0;document.getElementById("p"+t).remove()}else{n.value=parseFloat(n.value)+parseFloat(e.oldvalue)-parseFloat(e.value)}}else if(r<parseFloat(e.oldvalue)){var o=e.parentNode.parentNode.parentNode.cloneNode(true);o.addEventListener("dragstart",shopOrder.productPackage_dragstart_handler);o.id="p"+t;o.children[1].children[1].children[0].disabled=true;o.children[0].children[0].style.display="none";o.children[1].children[1].children[0].value=e.oldvalue-e.value;document.getElementById("shipping_packages").appendChild(o)}else{e.value=e.oldvalue}if(parseFloat(e.value)<=0){e.parentNode.parentNode.parentNode.remove()}document.getElementById("shipping_packages_products").value=shopOrder.getPackagesProductsJson()}else{e.value=e.oldvalue}e.oldvalue=e.value}productPackage_start_change_quantity(e=this){e.oldvalue=e.value}productPackage_drop_handler(e){e.preventDefault();var t=e.target;var r=e.dataTransfer.getData("text/html");if(r.indexOf('">')>0){r=r.substring(r.indexOf('">')+2)}var n=parseFloat(document.getElementById(r).children[1].children[1].children[0].value);var o=t.id;while(t.id!="packages"){if(t.id.indexOf("ack")>0){o=t.id}t=t.parentNode}t=document.getElementById(o).children[2].children[0];if(document.getElementById(r).id.indexOf("_")>0){var a=t.parentNode.parentNode.id+"_"+document.getElementById(r).id.substring(document.getElementById(r).id.indexOf("_")+1)}else{var a=t.parentNode.parentNode.id+"_"+document.getElementById(r).id}if(document.getElementById(r).id==a){return}var d=1;if(n>1){var d=parseFloat(prompt("Quantity"))}if(isNaN(d)){d=n}if(d>n){d=n}if(d<n){document.getElementById(r).children[1].children[1].children[0].value=d;if(document.getElementById(a)){document.getElementById(a).children[1].children[1].children[0].value=parseFloat(document.getElementById(a).children[1].children[1].children[0].value)+d}else{var i=document.getElementById(r).cloneNode(true);i.id=a;i.addEventListener("dragstart",shopOrder.productPackage_dragstart_handler);t.appendChild(i)}document.getElementById(r).children[1].children[1].children[0].value=n-d}else{if(document.getElementById(a)&&document.getElementById(r).id!=a){document.getElementById(a).children[1].children[1].children[0].value=parseFloat(document.getElementById(a).children[1].children[1].children[0].value)+d;document.getElementById(r).remove()}else{document.getElementById(r).id=a;t.appendChild(document.getElementById(a))}}var l=document.getElementById(a).children[1].children[1].children[0];l.disabled=false;l.addEventListener("change",shopOrder.productPackage_change_quantity);l.addEventListener("focus",shopOrder.productPackage_start_change_quantity);document.getElementById(a).children[0].children[0].style.display="";document.getElementById("shipping_packages_products").value=shopOrder.getPackagesProductsJson()}delete_from_return_package(e){e.style.display="none";var t=e.parentNode.parentNode;var r=t.id.substring(t.id.lastIndexOf("_")+1);if(document.getElementById("return_"+r)){document.getElementById("return_"+r).querySelector(".product_quantity").value=parseFloat(document.getElementById("return_"+r).querySelector(".product_quantity").value)+parseFloat(t.querySelector(".product_quantity").value);t.remove()}else{t.id="return_"+r;t.querySelector(".product_quantity").disabled=true;t.querySelector(".return_reason").setAttribute("name","");t.querySelector(".return_product_quantity").setAttribute("name","");t.querySelector(".customer_comment").setAttribute("name","");t.querySelector(".admin_notice").setAttribute("name","");t.querySelector(".return_package_product_id").setAttribute("name","");t.setAttribute("name","");document.getElementById("returns_packages").appendChild(t)}}getReturnPackagesProductsJson(){const e=document.getElementById("return_packages");var t=new Array;var r="{";for(let l=0;l<e.children.length;l++){var n=e.children[l].children[1].children[0];var o=e.children[l].id.substring(11);if(r[r.length-1]=="}")r=r+",";r=r+'"'+o+'":{';var a=new Array;for(let e=0;e<n.children.length;e++){var d=n.children[e].id;var i=d.substring(d.lastIndexOf("_")+2);if(i.length>0){a[i]=parseFloat(n.querySelector(".product_quantity").value);if(r[r.length-1]!="{")r=r+",";r=r+'"'+i+'":'+parseFloat(n.querySelector(".product_quantity").value)}}r=r+"}";t[o]=a}r=r+"}";return r}setSavedReturnPackages(e){let t=document.getElementById(e);if(t){t.value=this.getReturnPackagesProductsJson()}}orderedit_return_package_add(e){return_package_index++;let t=document.getElementById("return_packages");if(t){if(t.children[0]){var r=t.children[0].cloneNode(true);if(r){r.id="return_pack"+return_package_index;r.querySelector(".return_package_id").value=return_package_index;r.querySelector(".return_package_status").setAttribute("name","return_package_status["+return_package_index+"]");r.children[0].children[2].innerHTML=return_package_index;r.children[0].children[4].children[0].value="";r.children[1].innerHTML="<span>"+e+"</span>";t.appendChild(r)}}else{var n=document.querySelector("#templateOfOrderReturnPack");var o=n.content.cloneNode(true);var r=o.querySelector("#return_pack1");r.id="return_pack"+return_package_index;r.querySelector(".return_package_id").value=return_package_index;r.querySelector(".return_package_status").setAttribute("name","return_package_status["+return_package_index+"]");r.children[0].children[2].innerHTML=return_package_index;r.children[0].children[4].children[0].value="";r.children[1].innerHTML="<span>"+e+"</span>";t.appendChild(r)}}}productReturnPackage_dragover_handler(e){e.preventDefault();e.dataTransfer.dropEffect="copy";e.dataTransfer.effectAllowed="copy"}productReturnPackage_dragstart_handler(e){e.dataTransfer.setData("text/html",e.target.id);e.dataTransfer.dropEffect="copy";e.dataTransfer.effectAllowed="copy"}productReturnPackage_change_quantity(e=this){if(typeof e.name!="undefined"&&e!=null){if(parseFloat(e.value)<0){e.value=0}var t=e.id.substring(e.id.lastIndexOf("_")+1);var r=parseFloat(e.value);if(document.getElementById("return_p"+t)){var n=document.getElementById("return_p"+t).querySelector(".return_product_quantity");if(parseFloat(e.value)>=parseFloat(e.oldvalue)+parseFloat(n.value)){e.value=parseFloat(e.oldvalue)+parseFloat(n.value);n.value=0;document.getElementById("return_p"+t).remove()}else{n.value=parseFloat(n.value)+parseFloat(e.oldvalue)-parseFloat(e.value)}}else if(r<parseFloat(e.oldvalue)){var o=e.parentNode.parentNode.parentNode.cloneNode(true);o.addEventListener("dragstart",shopOrder.productReturnPackage_dragstart_handler);o.id="return_p"+t;o.children[1].children[1].children[0].disabled=true;o.children[0].children[0].style.display="none";o.children[1].children[1].children[0].value=e.oldvalue-e.value;document.getElementById("returns_packages").appendChild(o);if(r<=0){e.parentNode.parentNode.parentNode.remove()}}else{e.value=e.oldvalue}var a=e.parentNode.parentNode.parentNode;if(parseFloat(e.value)<=0){a.remove()}}else{e.value=e.oldvalue}e.oldvalue=e.value}productReturnPackage_start_change_quantity(e=this){e.oldvalue=e.value}productReturnPackage_drop_handler(e){e.preventDefault();var t=e.target;var r=e.dataTransfer.getData("text/html");if(r.indexOf('">')>0){r=r.substring(r.lastIndexOf('">')+2)}var n=parseFloat(document.getElementById(r).querySelector(".product_quantity").value);if(!t.id){var t=e.target.parentNode}var o=t.id;while(t.id!="return_packages"){if(t.id.indexOf("ack")>0){o=t.id}t=t.parentNode}t=document.getElementById(o).children[1];if(document.getElementById(r).id.indexOf("_")>1){var a=t.parentNode.id+"_"+document.getElementById(r).id.substring(document.getElementById(r).id.lastIndexOf("_")+1)}else{var a=t.parentNode.parentNode.id+"_"+document.getElementById(r).id}var d=a.substring(a.indexOf("return_pack")+11);var i=d.substring(d.indexOf("_"),0);var l=d.substring(d.indexOf("_")+2);if(document.getElementById(r).id==a){return}var u=1;if(n>1){var u=parseFloat(prompt("Quantity"))}if(isNaN(u)){u=n}if(u>n){u=n}if(u<n){document.getElementById(r).querySelector(".product_quantity").value=u;if(document.getElementById(a)){document.getElementById(a).querySelector(".return_product_quantity").value=parseFloat(document.getElementById(a).querySelector(".return_product_quantity").value)+u}else{var c=document.getElementById(r).cloneNode(true);c.id=a;c.addEventListener("dragstart",shopOrder.productReturnPackage_dragstart_handler);t.children[0].appendChild(c)}document.getElementById(r).querySelector(".product_quantity").value=n-u}else{if(document.getElementById(a)&&document.getElementById(r).id!=a){document.getElementById(a).querySelector(".product_quantity").value=parseFloat(document.getElementById(a).querySelector(".product_quantity").value)+u;document.getElementById(r).remove()}else{document.getElementById(r).id=a;t.children[0].appendChild(document.getElementById(a))}}document.getElementById(a).querySelector(".return_reason").setAttribute("name","return_reason["+i+"]["+l+"]");document.getElementById(a).querySelector(".customer_comment").setAttribute("name","customer_comment["+i+"]["+l+"]");document.getElementById(a).querySelector(".admin_notice").setAttribute("name","admin_notice["+i+"]["+l+"]");document.getElementById(a).querySelector(".return_package_product_id").setAttribute("name","return_package_product_id["+i+"]["+l+"]");document.getElementById(a).querySelector(".return_product_quantity").setAttribute("name","return_product_quantity["+i+"]["+l+"]");document.getElementById(a).querySelectorAll(".d-none").forEach(function(e){e.classList.remove("d-none")});var s=document.getElementById(a).querySelector(".product_quantity");s.disabled=false;s.addEventListener("change",shopOrder.productReturnPackage_change_quantity);s.addEventListener("focus",shopOrder.productReturnPackage_start_change_quantity);document.getElementById(a).querySelector(".delete_package").style.display=""}delete_package(e,t,r){t.preventDefault();if(!confirm(r))return false;var n=e.parentNode.parentNode.parentNode;var o=n.id;var a=document.getElementById(o).querySelectorAll(".package_product_line");var d="";if(a){a.forEach(function(e){d=e.querySelector(".delete_package");if(d){shopOrder.delete_from_package(d)}})}n.remove();document.getElementById("shipping_packages_products").value=this.getPackagesProductsJson()}delete_return_package(e,t,r){t.preventDefault();if(!confirm(r))return false;var n=e.parentNode.parentNode.parentNode;var o=n.id;var a=document.getElementById(o).querySelectorAll(".return_product_line");var d="";if(a){a.forEach(function(e){d=e.querySelector(".delete_package");if(d){shopOrder.delete_from_return_package(d)}})}n.remove()}}var A=new ShopOrder;class ShopRefund{constructor(){this.number=100}updateRefundSubtotal(e){let t=0;let r=/refund[\index/][product_item_price]\[(\d+)\]/i;let n=document.querySelectorAll(`input[name^='refund[${e}][product_item_price]']`);r=new RegExp(r);if(n){n.forEach(function(n){let o=0;let a=r.exec(n.getAttribute("name"));let d=n.name.substring(n.name.lastIndexOf("[")+1,n.name.length-1);let i=parseFloat(n.value.replace(",","."));let l=document.querySelector(`input[name="refund[${e}][product_quantity][${d}]"]`);let u=parseFloat(l.value.replace(",","."));let c=document.querySelector(`input[name="refund[${e}][product_one_time_price][${d}]"]`);if(c){o=parseFloat(c.value.replace(",","."))}if(isNaN(i))i=0;if(isNaN(u))u=0;t+=i*u+o})}let o=document.querySelector(`input[name='refund[${e}][subtotal]']`);if(o){o.value=t}this.updateRefundTotal(e);this.calculateTax(e)}updateRefundTotal(e){console.log("index");let t=0;let r=parseFloat(document.querySelector(`input[name='refund[${e}][subtotal]']`).value.replace(",","."));let n=parseFloat(document.querySelector(`input[name='refund[${e}][discount]']`).value.replace(",","."));let o=parseFloat(document.querySelector(`input[name='refund[${e}][shipping]']`).value.replace(",","."));let a=parseFloat(document.querySelector(`input[name='refund[${e}][package]']`).value.replace(",","."));let d=parseFloat(document.querySelector(`input[name='refund[${e}][payment]']`).value.replace(",","."));if(isNaN(r))r=0;if(isNaN(n))n=0;if(isNaN(o))o=0;if(isNaN(a))a=0;if(isNaN(d))d=0;t=r-n+o+a+d;let i=document.querySelector("#display_price");if(i&&i.value==1){let r=document.querySelectorAll(`input[name^='refund[${e}][tax_value]']`);if(r){r.forEach(function(e){let r=parseFloat(e.value.replace(",","."));if(isNaN(r))r=0;t+=r})}}document.querySelector(`input[name='refund[${e}][total]']`).value=t}calculateTax(e){var t=window.shopOrderAndOffer;let r=document.querySelector("#user_id");let n=t.getList(e);let o=t.getData(e);let a="index.php?option=com_jshopping&controller=orders&task=loadtaxorder";o["product"]=n;let d={data_order:o};JSON.stringify(d);if(r&&r.value)a+=`&admin_load_user_id=${r.value}`;fetch(a,{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{let r=document.querySelector(`input[name="refund[${e}][tax_percent][]"]`);if(r){r.parentElement.parentElement.remove()}for(let r=0;r<t.length;r++){let n=`\n                    <tr class='bold'>\n                        <td class="right">\n                            <input type="text" class="small3" name="refund[${e}][tax_percent][]" value="${t[r]["tax"]}"/> %\n                        </td>\n                        <td class="left">\n                            <input type="text" class="small3" name="refund[${e}][tax_value][]" onkeyup="shopRefund.updateRefundTotal(index);" value="${t[r]["value"]}"/>\n                        </td>\n                    </tr>\n                `;document.querySelector("#row_button_add_tax").innerHTML+=n}shopRefund.updateRefundTotal(e)})}getList(e){let t=end_number_order_item+1;let r={};for(let n=1;n<=t;n++){let t=document.querySelector(`input[name="refund[${e}][product_id][${n}]"]`);if(!t)continue;let o=t.value;if(!o)continue;let a={product_id:o};let d=document.querySelector(`input[name="refund[${e}][product_freeattributes][${n}]"]`);let i=document.querySelector(`input[name="refund[${e}][product_item_price][${n}]"]`);let l=document.querySelector(`input[name="refund[${e}][product_one_time_price][${n}]"]`);let u=document.querySelector(`input[name="refund[${e}][product_attributes][${n}]"]`);let c=document.querySelector(`input[name="refund[${e}][delivery_times_id][${n}]"]`);let s=document.querySelector(`input[name="refund[${e}][product_quantity][${n}]"]`);let p=document.querySelector(`input[name="refund[${e}][order_item_id][${n}]"]`);let _=document.querySelector(`input[name="refund[${e}][product_name][${n}]"]`);let m=document.querySelector(`input[name="refund[${e}][product_ean][${n}]"]`);let h=document.querySelector(`input[name="refund[${e}][thumb_image][${n}]"]`);let f=document.querySelector(`input[name="refund[${e}][vendor_id][${n}]"]`);let g=document.querySelector(`input[name="refund[${e}][weight][${n}]"]`);if(d){a["product_freeattributes"]=d.value}if(i){a["product_item_price"]=i.value.replace(",",".")}if(l){a["one_time_cost"]=l.value.replace(",",".")}if(u){a["product_attributes"]=u.value}if(c){a["delivery_times_id"]=c.value}if(s){a["product_quantity"]=s.value.replace(",",".")}if(p){a["order_item_id"]=p.value}if(_){a["product_name"]=_.value}if(m){a["product_ean"]=m.value}if(h){a["thumb_image"]=h.value}if(f){a["vendor_id"]=f.value}if(g){a["weight"]=g.value}r[n]=a}return r}addTaxRow(e){let t='<tr><td class="right"><input type="text" class="small3 form-control" name="refund['+e+'][tax_percent][]"/> %</td><td class="left"><input type="text" class="small3 form-control" name="refund['+e+'][tax_value][]" onkeyup="shopRefund.updateRefundTotal('+e+');"/></td></tr>';let r=document.querySelector("#refund_row_button_add_tax_"+e);if(r){r.insertAdjacentHTML("beforebegin",t)}}start_refund(){refund_index++;var e=document.querySelector("#template_refund_block");var t=e.content.cloneNode(true);var r=t.querySelector("#refund_block");var n=r.innerHTML.replaceAll("refund[0]","refund["+refund_index+"]");n=n.replaceAll("index",refund_index);r.innerHTML=n;document.querySelector("#refunds_block").appendChild(r);var o=refund_index+1;document.querySelector(".refund_butt").value="Start refund  "+o}}var E=new ShopRefund;class ShopStates{constructor(){document.addEventListener("DOMContentLoaded",function(){let e=document.querySelector("#country");let t=document.querySelector("#d_country");let r=document.querySelector("#countries_id");if(e){e.setAttribute("onchange","shopStates.getState(this.id, this.value, document.querySelector('#state').value);");let t=document.querySelector("#state");if(t){shopStates.getState("country",e.value,t.value)}}if(t){t.setAttribute("onchange","shopStates.getState(this.id, this.value, document.querySelector('#d_state').value);");let e=document.querySelector("#state");if(e){shopStates.getState("d_country",t.value,e.value)}}let n=document.querySelector("#shop-qcheckout .modal-header button.close");if(n){n.addEventListener("click",function(){refreshDataForAllSections()})}if(r){let e=r.parentNode;e.insertAdjacentHTML("beforeend","<div id='qwerty'></div>");shopStates.getState2(r.value)}var o=[];if(document.querySelector("#countries_id")!=null){document.querySelector("#countries_id").addEventListener("change",function(){for(var e=0;e<this.selectedOptions.length;e++){o[e]=this.selectedOptions[e].value}if(o.length<2){shopStates.getState2(o)}else{shopStates.getState2([],[])}})}})}getState(e,t,r){let n=Joomla.getOptions("urlStates")+`&country_id=${t}&id=${e}&state_val=${r}`;fetch(n).then(e=>e.json()).then(t=>{if(t.status=="OK"){if(e=="country"){let e=document.querySelector("#state");if(e){e.parentNode.innerHTML=t.select_states}}if(e=="d_country"){let e=document.querySelector("#d_state");if(e){e.parentNode.innerHTML=t.select_states}}}})}see_states(e){let t=e.options[e.selectedIndex].value;let r=document.querySelector(".inputbox_st");let n=document.querySelector(`#state_c_${t}`);if(r){r.style.display="none"}if(n){n.style.display="block"}}getState2(e){let t=Joomla.getOptions("exttaxes_id");let r={value:e,exttaxes_id:t};let n=Joomla.getOptions("urlStates2");console.log(n);if(n){n+="&"+shopStates.objToStr(r);console.log(n);var o=new XMLHttpRequest;o.open("GET",n,true);o.setRequestHeader("Content-Type","application/json");o.send(r);o.onload=function(){var e=JSON.parse(this.responseText);if(e.status=="OK"){let t=document.querySelector("#qwerty");t.innerHTML=e.html;if(e.test)alert(e.test)}}}}getShippState(e){const t=document.querySelectorAll("#shipping_countries_id option:checked");if(document.querySelector(".states_list")){document.querySelector(".states_list").remove()}if(t){const n=Array.from(t).map(e=>e.value);if(n.length==1){let t=Joomla.getOptions("urlShippStates");let n={country_id:e.value};t+="&country_id="+e.value;var r=new XMLHttpRequest;r.open("GET",t,true);r.setRequestHeader("Content-Type","application/json");r.send(n);r.onload=function(){var e=JSON.parse(this.responseText);console.log(e.html);if(e.html!=""){var t=document.querySelectorAll(".shippingsprices_countries .form-group:first-child");t[0].insertAdjacentHTML("afterend",e.html)}}}else{}}let n=Joomla.getOptions("urlStates2");console.log(n);if(n){n+="&"+shopStates.objToStr(data);console.log(n);var r=new XMLHttpRequest;r.open("GET",n,true);r.setRequestHeader("Content-Type","application/json");r.send(data);r.onload=function(){var e=JSON.parse(this.responseText);if(e.status=="OK"){let t=document.querySelector("#qwerty");t.innerHTML=e.html;if(e.test)alert(e.test)}}}}objToStr(e){var t=[];for(var r in e){if(e.hasOwnProperty(r)){t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]))}}return t.join("&")}}var T=new ShopStates;window.shopHelper=n;window.shopAttributes=o;window.shopCategory=a;window.shopSearch=d;window.shopConfig=i;window.shopCoupon=l;window.shopEmailHub=u;window.shopImage=c;window.shopShipping=s;window.shopUser=p;window.shopOrderAndOffer=_;window.shopProductAttribute=h;window.shopProductCharacteristics=f;window.shopProductCommon=m;window.shopProductFreeAttribute=g;window.shopProductImage=y;window.shopProductPrice=v;window.shopPricePerConsigment=S;window.shopProductRelated=q;window.shopProductUserGroup=b;window.shopProductVideo=w;window.shopProductLabel=P;window.AdminShopNativeUploads=$;window.shopPage=k;window.shopReview=x;window.shopOrder=A;window.shopRefund=E;window.shopStates=T;window.shopPage.addToStackExecuteAfterDomReady(function(){let e=document.querySelectorAll(".textToSHDocBlankTarget");try{if(e&&e.length!=0){e.forEach(function(e){let t=e.closest("a");if(t){t.setAttribute("target","_blank")}})}else{let e=document.querySelector('#sidebarmenu a[href*="task=redirectToShopDocumentation"]');if(e){e.target="_blank"}}}catch(e){console.warn("I couldn`t find sidebar link to SmartShop documentation.")}});window.shopPage.executeAfterDomReady()}]);